<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
/>
<meta
  name="description"
  content="Design and implement your programming language and software analysis tools with mathematical rigor."
/>
<meta name="keywords" content="runtime, verification, rv, k" />
<meta name="author" content="K | Runtime Verification Inc" />
<meta name="robots" content="index, follow" />
<link rel="canonical" href="https://kframework.org/k-distribution/include/kframework/builtin/domains/" />

<!--favicon icon-->
<link rel="icon" type="image/png" href="../../../../../assets/img/favicon.ico" />

<title>Basic Builtin Types in K | Runtime Verification Inc</title>

<!-- <base href="/k/" /> -->

<!--web fonts-->
<link
  href="https://fonts.googleapis.com/css?family=Nunito:300,400,600,700,800"
  rel="stylesheet"
/>
<link
  href="https://fonts.googleapis.com/css?family=Lora:400i"
  rel="stylesheet"
/>

<link
  href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css"
  rel="stylesheet"
/>

<link href="../../../../../assets/css/index.css" rel="stylesheet" />

<!--[if (gt IE 9) |!(IE)]><!-->
<!--<link rel="stylesheet" href="/assets/vendor/custom-nav/css/effects/fade-menu.css"/>-->
<!-- <link rel="stylesheet" href="../../../../../assets/k/vl-nav/css/effects/slide-menu.css" /> -->
<!--<![endif]-->

  </head>

  <body>
<header
  class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar"
>
  <a class="logo-link" href="../../../../../index.html">
    <picture>
      <source
        srcset="../../../../../assets/img/k-logo-dark.png"
        media="(prefers-color-scheme: dark)"
      />
      <img src="../../../../../assets/img/k-logo.png" alt="K" style="height: 48px" />
    </picture>
    Semantic Framework
  </a>
  <ul class="navbar-nav ml-md-auto">
    <li class="nav-item dropdown">
      <a
        class="nav-link dropdown-toggle"
        href="#"
        id="navbarDropdown"
        role="button"
        data-toggle="dropdown"
        aria-haspopup="true"
        aria-expanded="false"
      >
        <i class="fas fa-book"></i>
      </a>
      <div class="dropdown-menu" aria-labelledby="navbarDropdown">
        <a class="dropdown-item" href="../../../../../exports/K.pdf">pdf</a>
        <a class="dropdown-item" href="../../../../../exports/K.epub">epub</a>
        <a class="dropdown-item" href="../../../../../exports/K.mobi">mobi</a>
        <a class="dropdown-item" href="../../../../../exports/K.html">html</a>
      </div>
    </li>
    <li class="nav-item">
      <a
        class="nav-link pl-2 pr-1 mx-1 py-3 my-n2"
        href="https://github.com/runtimeverification/k"
        target="_blank"
        rel="noopener"
        aria-label="GitHub"
      >
        <i class="fab fa-github"></i>
      </a>
    </li>
  </ul>
  <a
    class="btn btn-rv-blue d-none d-lg-inline-block mb-3 mb-md-0 ml-md-3"
    href="https://github.com/runtimeverification/k/releases/latest"
    >Download</a
  >
</header>
<style>
  .dropdown:hover .dropdown-menu {
    display: block;
    margin-top: 0; /* remove the gap so it doesn't close */
  }
</style>


    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 bd-sidebar mb-3">
  <form
    role="search"
    class="bd-search d-flex align-items-center justify-content-between"
  >
    <input
      type="search"
      class="form-control"
      placeholder="Search..."
      aria-label="Search for..."
      autocomplete="false"
      id="search-box"
    />
    <button
      class="btn bd-search-docs-toggle d-md-none p-0 ml-3 collapsed"
      type="button"
      aria-label="Toggle docs navigation"
      style="font-size: 1.4rem"
    >
      <i class="fas fa-bars"></i>
    </button>
  </form>
  <nav class="collapse bd-links" aria-label="Main navigation">
    <div class="sidebar-toc pl-2"><div>
<div style="padding:0.25rem 0;;padding-left: 8px;"><a href="../../../../../">Homepage</a></div>
<div style="padding:0.25rem 0;;padding-left: 8px;"><a href="https://github.com/runtimeverification/k/releases/latest">Install K</a></div>
<div style="padding:0.25rem 0;;padding-left: 8px;"><a href="https://kframework.org/pyk">Pyk Documentation</a></div>
<details style="padding:0.25rem 0;;padding-left: 8px;"><summary><a href="../../../../../k-distribution/k-tutorial/">K Tutorial</a></summary><div>
<details style="padding:0.25rem 0;;padding-left: 16px;"><summary><a href="../../../../../k-distribution/k-tutorial/1_basic/">Section 1: Basic K Concepts</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/01_installing/">Lesson 1.1: Setting up a K Environment</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/02_basics/">Lesson 1.2: Basics of Functional K</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/03_parsing/">Lesson 1.3: BNF Syntax and Parser Generation</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/04_disambiguation/">Lesson 1.4: Disambiguating Parses</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/05_modules/">Lesson 1.5: Modules, Imports, and Requires</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/06_ints_and_bools/">Lesson 1.6: Integers and Booleans</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/07_side_conditions/">Lesson 1.7: Side Conditions and Rule Priority</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/08_literate_programming/">Lesson 1.8: Literate Programming with Markdown</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/09_unparsing/">Lesson 1.9: Unparsing and the format and color attributes</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/10_strings/">Lesson 1.10: Strings</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/11_casts/">Lesson 1.11: Casting Terms</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/12_syntactic_lists/">Lesson 1.12: Syntactic Lists</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/13_rewrite_rules/">Lesson 1.13: Basics of K Rewriting</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/14_evaluation_order/">Lesson 1.14: Defining Evaluation Order</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/15_configurations/">Lesson 1.15: Configuration Declarations and Cell Nesting</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/16_collections/">Lesson 1.16: Maps, Semantic Lists, and Sets</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/17_cell_multiplicity/">Lesson 1.17: Cell Multiplicity and Cell Collections</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/18_equality_and_conditionals/">Lesson 1.18: Term Equality and the Ternary Operator</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/19_debugging/">Lesson 1.19: Debugging with GDB or LLDB</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/20_backends/">Lesson 1.20: K Backends and the Haskell Backend</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/21_symbolic_execution/">Lesson 1.21: Unification and Symbolic Execution</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/1_basic/22_proofs/">Lesson 1.22: K Deductive Verification</a></div>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 16px;"><summary><a href="../../../../../k-distribution/k-tutorial/2_intermediate/">Section 2: Intermediate K Concepts</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/01_macros/">Lesson 2.1: Macros, Aliases, and Anywhere Rules</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/02_fresh_constants/">Lesson 2.2: Fresh Constants</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/03_klabels/">Lesson 2.3: KLabels and Abstract Syntax</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/04_overloading/">Lesson 2.4: Overloaded Symbols</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/05_matching_logic/">Lesson 2.5: Matching Logic Connectives and #Or Patterns</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/06_function_context/">Lesson 2.6: Function Context</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/07_record_productions/">Lesson 2.7: Record Productions and Named Nonterminals</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/08_fun_and_let/">Lesson 2.8: #fun and #let</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/09_as/">Lesson 2.9: #as Patterns</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/10_matching_operator/">Lesson 2.10: The Matching Operators, :=K and :/=K</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/11_evaluation_order/">Lesson 2.11: Uncommon Evaluation Order Concepts</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/12_floats_and_machine_ints/">Lesson 2.12: IEEE 754 Floating Point and Fixed Width Integers</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/13_substitution/">Lesson 2.13: Alpha-renaming-aware Substitution</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/14_io/">Lesson 2.14: File I/O</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/15_string_buffers_and_bytes/">Lesson 2.15: String Buffers and Byte Sequences</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/16_kore/">Lesson 2.16: The Intermediate Language of K, KORE</a></div>
<div style="padding:0.25rem 0;;padding-left: 24px;"><a href="../../../../../k-distribution/k-tutorial/2_intermediate/17_debugging_proofs/">Lesson 2.17: Debugging Proofs using the Haskell Backend REPL</a></div>
</div></details>
</div></details>
<div style="padding:0.25rem 0;;padding-left: 8px;"><a href="../../../../../docs/user_manual/">K User Manual</a></div>
<div style="padding:0.25rem 0;;padding-left: 8px;"><a href="../../../../../docs/cheat_sheet/">K Cheat Sheet</a></div>
<div style="padding:0.25rem 0;;padding-left: 8px;"><a href="../../../../../docs/ktools/">K Tool Reference</a></div>
<details style="padding:0.25rem 0;;padding-left: 8px;"><summary><a href="../../../../../k-distribution/include/kframework/">K Builtins</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 16px;"><a href="../../../../../k-distribution/include/kframework/builtin/domains/">domains</a></div>
<div style="padding:0.25rem 0;;padding-left: 16px;"><a href="../../../../../k-distribution/include/kframework/builtin/kast/">kast</a></div>
<div style="padding:0.25rem 0;;padding-left: 16px;"><a href="../../../../../k-distribution/include/kframework/builtin/prelude/">prelude</a></div>
<div style="padding:0.25rem 0;;padding-left: 16px;"><a href="../../../../../k-distribution/include/kframework/builtin/ffi/">ffi</a></div>
<div style="padding:0.25rem 0;;padding-left: 16px;"><a href="../../../../../k-distribution/include/kframework/builtin/json/">json</a></div>
<div style="padding:0.25rem 0;;padding-left: 16px;"><a href="../../../../../k-distribution/include/kframework/builtin/rat/">rat</a></div>
<div style="padding:0.25rem 0;;padding-left: 16px;"><a href="../../../../../k-distribution/include/kframework/builtin/substitution/">substitution</a></div>
<div style="padding:0.25rem 0;;padding-left: 16px;"><a href="https://github.com/runtimeverification/k/blob/master/k-distribution/include/kframework/builtin/unification.k">unification</a></div>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 8px;"><summary><a href="../../../../../k-distribution/pl-tutorial/">K PL Tutorial</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 16px;"><a href="../../../../../overview/">K Overview</a></div>
<details style="padding:0.25rem 0;;padding-left: 16px;"><summary><a href="../../../../../k-distribution/pl-tutorial/1_k/">Learning K</a></summary><div>
<details style="padding:0.25rem 0;;padding-left: 24px;"><summary><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/">Part 1: Defining LAMBDA</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/lesson_1/">Lesson 1, LAMBDA: Syntax Modules and Basic K Commands</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/lesson_2/">Lesson 2, LAMBDA: Module Importing, Rules, Variables</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/lesson_3/">Lesson 3, LAMBDA: Evaluation Strategies using Strictness</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/lesson_4/">Lesson 4, LAMBDA: Generating Documentation; Latex Attributes</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/lesson_5/">Lesson 5, LAMBDA: Adding Builtins; Side Conditions</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/lesson_6/">Lesson 6, LAMBDA: Selective Strictness; Anonymous Variables</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/lesson_7/">Lesson 7, LAMBDA: Derived Constructs; Extending Predefined Syntax</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/lesson_8/">Lesson 8, LAMBDA: Multiple Binding Constructs</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/1_lambda/lesson_9/">Lesson 9, LAMBDA: A Complete and Commented Definition</a></div>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 24px;"><summary><a href="../../../../../k-distribution/pl-tutorial/1_k/2_imp/">Part 2: Defining IMP</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/2_imp/lesson_1/">Lesson 1, IMP: Defining a More Complex Syntax</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/2_imp/lesson_2/">Lesson 2, IMP: Defining a Configuration</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/2_imp/lesson_3/">Lesson 3, IMP: Computations, Results, Strictness; Rules Involving Cells</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/2_imp/lesson_4/">Lesson 4, IMP: Configuration Abstraction, Part 1; Types of Rules</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/2_imp/lesson_5/">Lesson 5, IMP: Completing and Documenting IMP</a></div>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 24px;"><summary><a href="../../../../../k-distribution/pl-tutorial/1_k/3_lambda++/">Part 3: Defining LAMBDA++</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/3_lambda++/lesson_1/">Lesson 1, LAMBDA++: Abrupt Changes of Control</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/3_lambda++/lesson_2/">Lesson 2, LAMBDA++: Semantic (Non-Syntactic) Computation Items</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/3_lambda++/lesson_3/">Lesson 3, LAMBDA++: Reusing Existing Semantics</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/3_lambda++/lesson_4/">Lesson 4, LAMBDA++: Do Not Reuse Blindly!</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/3_lambda++/lesson_5/">Lesson 5, LAMBDA++: More Semantic Computation Items</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/3_lambda++/lesson_6/">Lesson 6, LAMBDA++: Wrapping Up and Documenting LAMBDA++ (environment-based)</a></div>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 24px;"><summary><a href="../../../../../k-distribution/pl-tutorial/1_k/4_imp++/">Part 4: Defining IMP++</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/4_imp++/lesson_1/">Lesson 1, IMP++: Extending/Changing an Existing Language Syntax</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/4_imp++/lesson_2/">Lesson 2, IMP++: Configuration Refinement; Freshness</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/4_imp++/lesson_3/">Lesson 3, IMP++: Tagging; Superheat/Supercool Kompilation Options</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/4_imp++/lesson_4/">Lesson 4, IMP++: Semantic Lists; Input/Output Streaming</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/4_imp++/lesson_5/">Lesson 5, IMP++: Deleting, Saving and Restoring Cell Contents</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/4_imp++/lesson_6/">Lesson 6, IMP++: Adding/Deleting Cells Dynamically; Configuration Abstraction, Part 2</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/4_imp++/lesson_7/">Lesson 7, IMP++: Everything Changes: Syntax, Configuration, Semantics</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/4_imp++/lesson_8/">Lesson 8, IMP++: Wrapping up Larger Languages</a></div>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 24px;"><summary><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/">Part 5: Defining Type Systems</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/lesson_1/">Lesson 1, Type Systems: Imperative, Environment-Based Type Systems</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/lesson_2/">Lesson 2, Type Systems: Substitution-Based Higher-Order Type Systems</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/lesson_3/">Lesson 3, Type Systems: Environment-Based Higher-Order Type Systems</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/lesson_4/">Lesson 4, Type Systems: A Naive Substitution-Based Type Inferencer</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/lesson_5/">Lesson 5, Type Systems: A Naive Environment-Based Type Inferencer</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/lesson_6/">Lesson 6, Type Systems: Parallel Type Checkers/Inferencers</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/lesson_7/">Lesson 7, Type Systems: A Naive Substitution-based Polymorphic Type Inferencer</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/lesson_8/">Lesson 8, Type Systems: A Naive Environment-based Polymorphic Type Inferencer</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/1_k/5_types/lesson_9/">Lesson 9, Type Systems: Let-Polymorphic Type Inferencer (Damas-Hindley-Milner)</a></div>
</div></details>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 16px;"><summary><a href="../../../../../k-distribution/pl-tutorial/2_languages/">Learning Language Design and Semantics using K</a></summary><div>
<details style="padding:0.25rem 0;;padding-left: 24px;"><summary><a href="../../../../../k-distribution/pl-tutorial/2_languages/1_simple/1_untyped/simple-untyped/">Part 7: SIMPLE: Designing Imperative Programming Languages</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/2_languages/1_simple/1_untyped/simple-untyped/">Lesson 1, SIMPLE untyped</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/2_languages/1_simple/2_typed/1_static/simple-typed-static/">Lesson 2, SIMPLE typed static</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/2_languages/1_simple/2_typed/2_dynamic/simple-typed-dynamic/">Lesson 3, SIMPLE typed dynamic</a></div>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 24px;"><summary><a href="../../../../../k-distribution/pl-tutorial/2_languages/2_kool/1_untyped/kool-untyped/">Part 8: KOOL: Designing Object-Oriented Programming Languages</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/2_languages/2_kool/1_untyped/kool-untyped/">Lesson 1, KOOL untyped</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/2_languages/2_kool/2_typed/1_dynamic/kool-typed-dynamic/">Lesson 2, KOOL typed dynamic</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/2_languages/2_kool/2_typed/2_static/kool-typed-static/">Lesson 3, KOOL typed static</a></div>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 24px;"><summary><a href="../../../../../k-distribution/pl-tutorial/2_languages/3_fun/1_untyped/1_environment/fun-untyped/">Part 9: FUN: Designing Functional Programming Languages</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/2_languages/3_fun/1_untyped/1_environment/fun-untyped/">Lesson 1, FUN untyped, Environment-Based</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/2_languages/3_fun/1_untyped/2_substitution/fun-untyped/">Lesson 2, FUN untyped, Substitution-Based</a></div>
<div style="padding:0.25rem 0;;padding-left: 32px;">Lesson 3, FUN polymorphic type inferencer</div>
</div></details>
<details style="padding:0.25rem 0;;padding-left: 24px;"><summary><a href="../../../../../k-distribution/pl-tutorial/2_languages/4_logik/basic/logik/">Part 10: LOGIK: Designing Logic Programming Languages</a></summary><div>
<div style="padding:0.25rem 0;;padding-left: 32px;"><a href="../../../../../k-distribution/pl-tutorial/2_languages/4_logik/basic/logik/">Lesson 1, LOGIK</a></div>
</div></details>
</div></details>
</div></details>
<div style="padding:0.25rem 0;;padding-left: 8px;"><a href="../../../../../projects/">Projects using K</a></div>
</div></div>
  </nav>
</div>

        <main
          class="col-12 col-md-6 col-xl-8 py-md-3 pl-md-5 bd-content"
          role="main"
        >
          <div class="introduction markdown-preview"><html><head></head><body><h1 id="basic-builtin-types-in-k">Basic Builtin Types in K</h1>
<p>A major piece of the K prelude consists of a series of modules that contain
implementations of basic data types and language features in K. You do not need
to require this file yourself; it is required automatically in every K
definition unless <code>--no-prelude</code> is passed to kompile. K may not work correctly
if some of these modules do not exist or do not declare certain functions.</p>
<p>Note that some functions in the K prelude functions are not total, that is,
they are not defined on all possible input values. When you invoke such a
function on an undefined input, the behavior is undefined. In particular, when
this happens, interpreters generated by the K LLVM backend may crash.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">requires</span> <span class="token string">"kast.md"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="default-modules">Default Modules</h2>
<p>K declares certain modules that contain most of the builtins you usually want
when defining a language in K. In particular, this includes integers, booleans,
strings, identifiers, I/O, lists, maps, and sets. The <code>DOMAINS-SYNTAX</code> module
is designed to be imported by the syntax module of the language and contains
only the program-level syntax of identifiers, integers, booleans, and strings.
The <code>DOMAINS</code> module contains the rest of the syntax, including builtin
functions over those and the remaining types.</p>
<p>Note that not all modules are included in DOMAINS. A few less-common modules
are not, including <code>ARRAY</code>, <code>COLLECTIONS</code>, <code>FLOAT</code>, <code>STRING-BUFFER</code>, <code>BYTES</code>,
<code>K-REFLECTION</code>, <code>MINT</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> DOMAINS<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> SORT<span class="token operator">-</span>K
  <span class="token keyword">imports</span> ID<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> UNSIGNED<span class="token operator">-</span>INT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> BOOL<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> STRING<span class="token operator">-</span>SYNTAX
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> DOMAINS
  <span class="token keyword">imports</span> DOMAINS<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> INT
  <span class="token keyword">imports</span> BOOL
  <span class="token keyword">imports</span> STRING
  <span class="token keyword">imports</span> BASIC<span class="token operator">-</span>K
  <span class="token keyword">imports</span> LIST
  <span class="token keyword">imports</span> K<span class="token operator">-</span>IO
  <span class="token keyword">imports</span> MAP
  <span class="token keyword">imports</span> SET
  <span class="token keyword">imports</span> ID
  <span class="token keyword">imports</span> K<span class="token operator">-</span>EQUAL
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="arrays">Arrays</h2>
<p>Provided here is an implementation for fixed-sized, contiguous maps from <code>Int</code>
to <code>KItem</code>. In some previous versions of K, the <code>Array</code> type was a builtin type
backed by mutable arrays of objects. However, in modern K, the <code>Array</code> type is
implemented by means of the <code>List</code> type; users should not access this interface
directly and should instead make only of the functions listed below. Users of
this module should import only the <code>ARRAY</code> module.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> ARRAY<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private LIST

  <span class="token keyword">syntax</span> Array
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="array-lookup">Array lookup</h3>
<p>You can look up an element in an <code>Array</code> by its index in O(log(N)) time. Note
that the base of the logarithm is a relatively high number and thus the time is
effectively constant.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Array <span class="token string">"["</span> <span class="token keyword">Int</span> <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="array-update">Array update</h3>
<p>You can create a new <code>Array</code> with a new value for a key in O(log(N)) time, or
effectively constant.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Array <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Array <span class="token string">"["</span> key<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">"&lt;-"</span> value<span class="token punctuation">:</span> KItem <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token punctuation">[</span>_&lt;<span class="token operator">-</span>_<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="array-reset">Array reset</h3>
<p>You can create a new <code>Array</code> where a particular key is reset to its default
value in O(log(N)) time, or effectively constant.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Array <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Array <span class="token string">"["</span> <span class="token keyword">Int</span> <span class="token string">"&lt;-"</span> <span class="token string">"undef"</span> <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="multiple-array-update">Multiple array update</h3>
<p>You can create a new <code>Array</code> from a <code>List</code> <code>L</code> of size <code>N</code> where the <code>N</code>
elements starting at <code>index</code> are replaced with the contents of <code>L</code>, in
O(N*log(K)) time (where K is the size of the array), or effectively linear.
Having <code>index + N &gt; K</code> yields an exception.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Array <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> updateArray<span class="token punctuation">(</span>Array<span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> List<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="array-fill">Array fill</h3>
<p>You can create a new <code>Array</code> where the <code>length</code> elements starting at <code>index</code>
are replaced with <code>value</code>, in O(length*log(N)) time, or effectively linear.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Array <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> fillArray<span class="token punctuation">(</span>Array<span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> KItem<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="array-range-check">Array range check</h3>
<p>You can test whether an integer is within the bounds of an array in O(1) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">Int</span> <span class="token string">"in_keys"</span> <span class="token string">"("</span> Array <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">endmodule</span>

<span class="token keyword">module</span> ARRAY<span class="token operator">-</span>IN<span class="token operator">-</span>K <span class="token punctuation">[</span>private<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> public ARRAY<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private LIST
  <span class="token keyword">imports</span> private K<span class="token operator">-</span>EQUAL
  <span class="token keyword">imports</span> private INT
  <span class="token keyword">imports</span> private BOOL
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="array-creation">Array creation</h3>
<p>You can create an array with <code>length</code> elements where each element is
initialized to <code>value</code> in O(1) time. Note that the array is stored in a manner
where only the highest element that is actually modified is given a value
in its internal representation, which means that subsequent array operations
may incur a one-time O(N) resizing cost, possibly amortized across multiple
operations.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Array <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> makeArray<span class="token punctuation">(</span>length<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> KItem<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> public<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="implementation-of-arrays">Implementation of Arrays</h3>
<p>The remainder of this section consists of an implementation in K of the
operations listed above. Users of the <code>ARRAY</code> module should not make use
of any of the syntax defined in any of these modules.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Array <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> arr<span class="token punctuation">(</span>List<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> KItem<span class="token punctuation">)</span>

  <span class="token keyword">rule</span> makeArray<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> D<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">,</span> I<span class="token punctuation">,</span> D<span class="token punctuation">)</span>

  <span class="token keyword">rule</span> arr<span class="token punctuation">(</span>L<span class="token punctuation">:</span><span class="token punctuation">:</span>List<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _       <span class="token punctuation">)</span> <span class="token punctuation">[</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> L<span class="token punctuation">[</span>IDX<span class="token punctuation">]</span> <span class="token keyword">requires</span> <span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> IDX andBool IDX  &lt;<span class="token keyword">Int</span> size<span class="token punctuation">(</span>L<span class="token punctuation">)</span>
  <span class="token keyword">rule</span> arr<span class="token punctuation">(</span>_      <span class="token punctuation">,</span> _<span class="token punctuation">,</span> D<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">)</span> <span class="token punctuation">[</span> _        <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> D      <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> ensureOffsetList<span class="token punctuation">(</span>List<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> KItem<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> ensureOffsetList<span class="token punctuation">(</span>L<span class="token punctuation">:</span><span class="token punctuation">:</span>List<span class="token punctuation">,</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> D<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> L makeList<span class="token punctuation">(</span>IDX <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token operator">-</span><span class="token keyword">Int</span> size<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">,</span> D<span class="token punctuation">)</span> <span class="token keyword">requires</span>         IDX <span class="token operator">&gt;=</span><span class="token keyword">Int</span> size<span class="token punctuation">(</span>L<span class="token punctuation">)</span>
  <span class="token keyword">rule</span> ensureOffsetList<span class="token punctuation">(</span>L<span class="token punctuation">:</span><span class="token punctuation">:</span>List<span class="token punctuation">,</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> L                                      <span class="token keyword">requires</span> notBool IDX <span class="token operator">&gt;=</span><span class="token keyword">Int</span> size<span class="token punctuation">(</span>L<span class="token punctuation">)</span>

  <span class="token keyword">rule</span> arr<span class="token punctuation">(</span>L<span class="token punctuation">:</span><span class="token punctuation">:</span>List<span class="token punctuation">,</span> I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> D<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">)</span> <span class="token punctuation">[</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span> &lt;<span class="token operator">-</span> VAL<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">(</span>ensureOffsetList<span class="token punctuation">(</span>L<span class="token punctuation">,</span> IDX<span class="token punctuation">,</span> D<span class="token punctuation">)</span> <span class="token punctuation">[</span> IDX &lt;<span class="token operator">-</span> VAL <span class="token punctuation">]</span><span class="token punctuation">,</span> I<span class="token punctuation">,</span> D<span class="token punctuation">)</span>

  <span class="token keyword">rule</span> arr<span class="token punctuation">(</span>L<span class="token punctuation">:</span><span class="token punctuation">:</span>List<span class="token punctuation">,</span> I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> D<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">)</span> <span class="token punctuation">[</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span> &lt;<span class="token operator">-</span> undef <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">(</span>L<span class="token punctuation">,</span> I<span class="token punctuation">,</span> D<span class="token punctuation">)</span> <span class="token punctuation">[</span> IDX &lt;<span class="token operator">-</span> D <span class="token punctuation">]</span>

  <span class="token keyword">rule</span> updateArray<span class="token punctuation">(</span>arr<span class="token punctuation">(</span>L<span class="token punctuation">:</span><span class="token punctuation">:</span>List<span class="token punctuation">,</span> I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> D<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">)</span><span class="token punctuation">,</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> L2<span class="token punctuation">:</span><span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">(</span>updateList<span class="token punctuation">(</span>ensureOffsetList<span class="token punctuation">(</span>L<span class="token punctuation">,</span> IDX <span class="token operator">+</span><span class="token keyword">Int</span> size<span class="token punctuation">(</span>L2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">,</span> IDX<span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">,</span> D<span class="token punctuation">)</span>

  <span class="token keyword">rule</span> fillArray<span class="token punctuation">(</span>arr<span class="token punctuation">(</span>L<span class="token punctuation">:</span><span class="token punctuation">:</span>List<span class="token punctuation">,</span> I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> D<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">)</span><span class="token punctuation">,</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> LEN<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> VAL<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">(</span>fillList<span class="token punctuation">(</span>ensureOffsetList<span class="token punctuation">(</span>L<span class="token punctuation">,</span> IDX <span class="token operator">+</span><span class="token keyword">Int</span> LEN <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">,</span> IDX<span class="token punctuation">,</span> LEN<span class="token punctuation">,</span> VAL<span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">,</span> D<span class="token punctuation">)</span>

  <span class="token keyword">rule</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span> in_keys<span class="token punctuation">(</span>arr<span class="token punctuation">(</span>_<span class="token punctuation">,</span> I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> IDX <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">0</span> andBool IDX &lt;<span class="token keyword">Int</span> I
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> ARRAY<span class="token operator">-</span>SYMBOLIC <span class="token punctuation">[</span>symbolic<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> ARRAY<span class="token operator">-</span>IN<span class="token operator">-</span>K
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> ARRAY<span class="token operator">-</span>KORE
  <span class="token keyword">imports</span> ARRAY<span class="token operator">-</span>IN<span class="token operator">-</span>K
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> ARRAY
  <span class="token keyword">imports</span> ARRAY<span class="token operator">-</span>SYMBOLIC
  <span class="token keyword">imports</span> ARRAY<span class="token operator">-</span>KORE
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="maps">Maps</h2>
<p>Provided here is the syntax of an implementation of immutable, associative,
commutative maps from <code>KItem</code> to <code>KItem</code>. This type is hooked to an
implementation of maps provided by the backend. For more information on
matching on maps and allowable patterns for doing so, refer to K's
<a href="../USER_MANUAL/">user documentation</a>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> MAP
  <span class="token keyword">imports</span> private BOOL<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private INT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private LIST
  <span class="token keyword">imports</span> private SET

  <span class="token keyword">syntax</span> Map <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>Map<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="map-concatenation">Map concatenation</h3>
<p>The <code>Map</code> sort represents a generalized associative array. Each key can be
paired with an arbitrary value, and can be used to reference its associated
value. Multiple bindings for the same key are not allowed.</p>
<p>You can construct a new Map consisting of key/value pairs of two Maps. The
result is <code>#False</code> if the maps have keys in common (in particular, this will
yield an exception during concrete execution). This operation is O(N<em>log(M))
where N is the size of the smaller map, when it appears on the right hand side.
When it appears on the left hand side and all variables are bound, it is
O(N</em>log(M)) where M is the size of the map it is matching and N is the number
of elements being matched. When it appears on the left hand side containing
variables not bound elsewhere in the term, it is O(N^K) where N is the size of
the map it is matching and K is the number of unbound keys being matched. In
other words, one unbound variable is linear, two is quadratic, three is cubic,
etc.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Map <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Map Map                        <span class="token punctuation">[</span><span class="token class-name">left</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>concat<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_Map_<span class="token punctuation">)</span><span class="token punctuation">,</span> assoc<span class="token punctuation">,</span> comm<span class="token punctuation">,</span> unit<span class="token punctuation">(</span><span class="token punctuation">.</span>Map<span class="token punctuation">)</span><span class="token punctuation">,</span> element<span class="token punctuation">(</span>_<span class="token operator">|</span><span class="token operator">-</span>&gt;_<span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">format</span><span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">1</span><span class="token operator">%</span>n<span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-unit">Map unit</h3>
<p>The map with zero elements is represented by <code>.Map</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Map <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">".Map"</span>                         <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>unit<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span><span class="token punctuation">.</span>Map<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-elements">Map elements</h3>
<p>An element of a <code>Map</code> is constructed via the <code>|-&gt;</code> operator. The key is on the
left and the value is on the right.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Map <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> KItem <span class="token string">"|-&gt;"</span> KItem                      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>element<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">|</span><span class="token operator">-</span>&gt;_<span class="token punctuation">)</span><span class="token punctuation">,</span> injective<span class="token punctuation">]</span>

  <span class="token keyword">syntax priority</span> _<span class="token operator">|</span><span class="token operator">-</span>&gt;_ &gt; _Map_ <span class="token punctuation">.</span>Map
  <span class="token keyword">syntax non-assoc</span> _<span class="token operator">|</span><span class="token operator">-</span>&gt;_
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="map-lookup">Map lookup</h3>
<p>You can look up the value associated with the key of a map in O(log(N)) time.
Note that the base of the logarithm is a relatively high number and thus the
time is effectively constant. The value is <code>#False</code> if the key is not in the
map (in particular, this will yield an exception during concrete execution).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Map <span class="token string">"["</span> KItem <span class="token string">"]"</span>                    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>lookup<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>Map<span class="token punctuation">:</span>lookup<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-lookup-with-default">Map lookup with default</h3>
<p>You can also look up the value associated with the key of a map using a
total function that assigns a specific default value if the key is not present
in the map. This operation is also O(log(N)), or effectively constant.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Map <span class="token string">"["</span> KItem <span class="token string">"]"</span> <span class="token string">"orDefault"</span> KItem      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>lookupOrDefault<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>Map<span class="token punctuation">:</span>lookupOrDefault<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-update">Map update</h3>
<p>You can insert a key/value pair into a map in O(log(N)) time, or effectively
constant.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Map <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Map <span class="token string">"["</span> key<span class="token punctuation">:</span> KItem <span class="token string">"&lt;-"</span> value<span class="token punctuation">:</span> KItem <span class="token string">"]"</span>           <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>Map<span class="token punctuation">:</span>update<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>update<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">prefer</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-delete">Map delete</h3>
<p>You can remove a key/value pair from a map via its key in O(log(N)) time, or
effectively constant.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Map <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Map <span class="token string">"["</span> KItem <span class="token string">"&lt;-"</span> <span class="token string">"undef"</span> <span class="token string">"]"</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>remove<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token punctuation">[</span>_&lt;<span class="token operator">-</span>undef<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-difference">Map difference</h3>
<p>You can remove the key/value pairs in a map that are present in another map in
O(N*log(M)) time (where M is the size of the first map and N is the size of the
second), or effectively linear. Note that only keys whose value is the same
in both maps are removed. To remove all the keys in one map from another map,
you can say <code>removeAll(M1, keys(M2))</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Map <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Map <span class="token string">"-Map"</span> Map                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>difference<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="multiple-map-update">Multiple map update</h3>
<p>You can update a map by adding all the key/value pairs in the second map in
O(N*log(M)) time (where M is the size of the first map and N is the size of the
second map), or effectively linear. If any keys are present in both maps, the
value from the second map overwrites the value in the first. This function is
total, which is distinct from map concatenation, a partial function only
defined on maps with disjoint keys.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Map <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> updateMap<span class="token punctuation">(</span>Map<span class="token punctuation">,</span> Map<span class="token punctuation">)</span>            <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>updateAll<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="multiple-map-removal">Multiple map removal</h3>
<p>You can remove a <code>Set</code> of keys from a map in O(N*log(M)) time (where M is the
size of the <code>Map</code> and <code>N</code> is the size of the <code>Set</code>), or effectively linear.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Map <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> removeAll<span class="token punctuation">(</span>Map<span class="token punctuation">,</span> Set<span class="token punctuation">)</span>            <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>removeAll<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-keys-(as-set)">Map keys (as <code>Set</code>)</h3>
<p>You can get a <code>Set</code> of all the keys in a Map in O(N) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> keys<span class="token punctuation">(</span>Map<span class="token punctuation">)</span>                      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>keys<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-keys-(as-list)">Map keys (as <code>List</code>)</h3>
<p>You can get a <code>List</code> of all the keys in a Map in O(N) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"keys_list"</span> <span class="token string">"("</span> Map <span class="token string">")"</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>keys_list<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-key-membership">Map key membership</h3>
<p>You can check whether a key is present in a map in O(1) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> KItem <span class="token string">"in_keys"</span> <span class="token string">"("</span> Map <span class="token string">")"</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>in_keys<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-values-(as-list)">Map values (as <code>List</code>)</h3>
<p>You can get a <code>List</code> of all the values in a map in O(N) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> values<span class="token punctuation">(</span>Map<span class="token punctuation">)</span>                   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-size">Map size</h3>
<p>You can get the number of key/value pairs in a map in O(1) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> size<span class="token punctuation">(</span>Map<span class="token punctuation">)</span>                      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>sizeMap<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-inclusion">Map inclusion</h3>
<p>You can determine whether a <code>Map</code> is a strict subset of another <code>Map</code> in O(N)
time (where N is the size of the first map). Only keys that are bound to the
same value are considered equal.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Map <span class="token string">"&lt;=Map"</span> Map               <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>inclusion<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="map-choice">Map choice</h3>
<p>You can get an arbitrarily chosen key of a <code>Map</code> in O(1) time. The same key
will always be returned for the same map, but no guarantee is given that two
different maps will return the same element, even if they are similar.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> choice<span class="token punctuation">(</span>Map<span class="token punctuation">)</span>                      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MAP<span class="token punctuation">.</span>choice<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>Map<span class="token punctuation">:</span>choice<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="implementation-of-maps">Implementation of Maps</h3>
<p>The remainder of this section contains lemmas used by the Java and Haskell
backend to simplify expressions of sort <code>Map</code>. They do not affect the semantics
of maps, merely describing additional rules that the backend can use to
simplify terms.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">endmodule</span>

<span class="token keyword">module</span> MAP<span class="token operator">-</span>KORE<span class="token operator">-</span>SYMBOLIC <span class="token punctuation">[</span>symbolic<span class="token punctuation">,</span>haskell<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> MAP
  <span class="token keyword">imports</span> private K<span class="token operator">-</span>EQUAL
  <span class="token keyword">imports</span> private BOOL

  <span class="token keyword">rule</span> #Ceil<span class="token punctuation">(</span>@M<span class="token punctuation">:</span>Map <span class="token punctuation">[</span>@K<span class="token punctuation">:</span>KItem<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>@K in_keys<span class="token punctuation">(</span>@M<span class="token punctuation">)</span><span class="token punctuation">)</span> #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> #And #Ceil<span class="token punctuation">(</span>@M<span class="token punctuation">)</span> #And #Ceil<span class="token punctuation">(</span>@K<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token comment">// Symbolic update</span>

  <span class="token comment">// Adding the definedness condition `notBool (K in_keys(M))` in the ensures clause of the following rule would be redundant</span>
  <span class="token comment">// because K also appears in the rhs, preserving the case when it's #Bottom.</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>K <span class="token operator">|</span><span class="token operator">-</span>&gt; _ M<span class="token punctuation">:</span>Map<span class="token punctuation">)</span> <span class="token punctuation">[</span> K &lt;<span class="token operator">-</span> V <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>K <span class="token operator">|</span><span class="token operator">-</span>&gt; V M<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> M<span class="token punctuation">:</span>Map <span class="token punctuation">[</span> K &lt;<span class="token operator">-</span> V <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>K <span class="token operator">|</span><span class="token operator">-</span>&gt; V M<span class="token punctuation">)</span> <span class="token keyword">requires</span> notBool <span class="token punctuation">(</span>K in_keys<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> M<span class="token punctuation">:</span>Map <span class="token punctuation">[</span> K &lt;<span class="token operator">-</span> _ <span class="token punctuation">]</span> <span class="token punctuation">[</span> K &lt;<span class="token operator">-</span> V <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> M <span class="token punctuation">[</span> K &lt;<span class="token operator">-</span> V <span class="token punctuation">]</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token comment">// Adding the definedness condition `notBool (K1 in_keys(M))` in the ensures clause of the following rule would be redundant</span>
  <span class="token comment">// because K1 also appears in the rhs, preserving the case when it's #Bottom.</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>K1 <span class="token operator">|</span><span class="token operator">-</span>&gt; V1 M<span class="token punctuation">:</span>Map<span class="token punctuation">)</span> <span class="token punctuation">[</span> K2 &lt;<span class="token operator">-</span> V2 <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>K1 <span class="token operator">|</span><span class="token operator">-</span>&gt; V1 <span class="token punctuation">(</span>M <span class="token punctuation">[</span> K2 &lt;<span class="token operator">-</span> V2 <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">requires</span> K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2 <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token comment">// Symbolic remove</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>K <span class="token operator">|</span><span class="token operator">-</span>&gt; _ M<span class="token punctuation">:</span>Map<span class="token punctuation">)</span> <span class="token punctuation">[</span> K &lt;<span class="token operator">-</span> undef <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> M ensures notBool <span class="token punctuation">(</span>K in_keys<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> M<span class="token punctuation">:</span>Map <span class="token punctuation">[</span> K &lt;<span class="token operator">-</span> undef <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> M <span class="token keyword">requires</span> notBool <span class="token punctuation">(</span>K in_keys<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token comment">// Adding the definedness condition `notBool (K1 in_keys(M))` in the ensures clause of the following rule would be redundant</span>
  <span class="token comment">// because K1 also appears in the rhs, preserving the case when it's #Bottom.</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>K1 <span class="token operator">|</span><span class="token operator">-</span>&gt; V1 M<span class="token punctuation">:</span>Map<span class="token punctuation">)</span> <span class="token punctuation">[</span> K2 &lt;<span class="token operator">-</span> undef <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>K1 <span class="token operator">|</span><span class="token operator">-</span>&gt; V1 <span class="token punctuation">(</span>M <span class="token punctuation">[</span> K2 &lt;<span class="token operator">-</span> undef <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">requires</span> K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2 <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token comment">// Symbolic lookup</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>K  <span class="token operator">|</span><span class="token operator">-</span>&gt;  V M<span class="token punctuation">:</span>Map<span class="token punctuation">)</span> <span class="token punctuation">[</span> K <span class="token punctuation">]</span>  <span class="token operator">=&gt;</span> V ensures notBool <span class="token punctuation">(</span>K in_keys<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>K1 <span class="token operator">|</span><span class="token operator">-</span>&gt; _V M<span class="token punctuation">:</span>Map<span class="token punctuation">)</span> <span class="token punctuation">[</span> K2 <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> M <span class="token punctuation">[</span>K2<span class="token punctuation">]</span> <span class="token keyword">requires</span> K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2 ensures notBool <span class="token punctuation">(</span>K1 in_keys<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>_MAP<span class="token punctuation">:</span>Map <span class="token punctuation">[</span> K  &lt;<span class="token operator">-</span>  V1 <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">[</span> K <span class="token punctuation">]</span>  <span class="token operator">=&gt;</span> V1 <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span> MAP<span class="token punctuation">:</span>Map <span class="token punctuation">[</span> K1 &lt;<span class="token operator">-</span> _V1 <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">[</span> K2 <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> MAP <span class="token punctuation">[</span> K2 <span class="token punctuation">]</span> <span class="token keyword">requires</span> K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2 <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token punctuation">(</span>K  <span class="token operator">|</span><span class="token operator">-</span>&gt;  V M<span class="token punctuation">:</span>Map<span class="token punctuation">)</span> <span class="token punctuation">[</span>  K <span class="token punctuation">]</span> orDefault _ <span class="token operator">=&gt;</span> V ensures notBool <span class="token punctuation">(</span>K in_keys<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>K1 <span class="token operator">|</span><span class="token operator">-</span>&gt; _V M<span class="token punctuation">:</span>Map<span class="token punctuation">)</span> <span class="token punctuation">[</span> K2 <span class="token punctuation">]</span> orDefault D <span class="token operator">=&gt;</span> M <span class="token punctuation">[</span>K2<span class="token punctuation">]</span> orDefault D <span class="token keyword">requires</span> K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2 ensures notBool <span class="token punctuation">(</span>K1 in_keys<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>_MAP<span class="token punctuation">:</span>Map <span class="token punctuation">[</span> K  &lt;<span class="token operator">-</span>  V1 <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">[</span> K <span class="token punctuation">]</span> orDefault _ <span class="token operator">=&gt;</span> V1 <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span> MAP<span class="token punctuation">:</span>Map <span class="token punctuation">[</span> K1 &lt;<span class="token operator">-</span> _V1 <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">[</span> K2 <span class="token punctuation">]</span> orDefault D <span class="token operator">=&gt;</span> MAP <span class="token punctuation">[</span> K2 <span class="token punctuation">]</span> orDefault D <span class="token keyword">requires</span> K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2 <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">.</span>Map <span class="token punctuation">[</span> _ <span class="token punctuation">]</span> orDefault D <span class="token operator">=&gt;</span> D <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token comment">// Symbolic in_keys</span>
  <span class="token keyword">rule</span> K in_keys<span class="token punctuation">(</span>_M <span class="token punctuation">[</span> K &lt;<span class="token operator">-</span> undef <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> K in_keys<span class="token punctuation">(</span>_M <span class="token punctuation">[</span> K &lt;<span class="token operator">-</span> _ <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> K1 in_keys<span class="token punctuation">(</span>M <span class="token punctuation">[</span> K2 &lt;<span class="token operator">-</span> _ <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span> <span class="token keyword">requires</span> K1 <span class="token operator">==</span>K K2 orBool K1 in_keys<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> K1 in_keys<span class="token punctuation">(</span>M <span class="token punctuation">[</span> K2 &lt;<span class="token operator">-</span> _ <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> K1 in_keys<span class="token punctuation">(</span>M<span class="token punctuation">)</span> <span class="token keyword">requires</span> K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2 <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals @Key in_keys<span class="token punctuation">(</span><span class="token punctuation">.</span>Map<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> #Ceil<span class="token punctuation">(</span>@Key<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>@Key in_keys<span class="token punctuation">(</span><span class="token punctuation">.</span>Map<span class="token punctuation">)</span> #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> #Ceil<span class="token punctuation">(</span>@Key<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals @Key in_keys<span class="token punctuation">(</span>Key<span class="token string">' |-&gt; Val @M)} =&gt; #Ceil(@Key) #And #Ceil(Key'</span> <span class="token operator">|</span><span class="token operator">-</span>&gt; Val @M<span class="token punctuation">)</span> #And #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>@Key #Equals Key'<span class="token punctuation">}</span><span class="token punctuation">)</span> #And <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals @Key in_keys<span class="token punctuation">(</span>@M<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>@Key in_keys<span class="token punctuation">(</span>Key<span class="token string">' |-&gt; Val @M) #Equals false} =&gt; #Ceil(@Key) #And #Ceil(Key'</span> <span class="token operator">|</span><span class="token operator">-</span>&gt; Val @M<span class="token punctuation">)</span> #And #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>@Key #Equals Key'<span class="token punctuation">}</span><span class="token punctuation">)</span> #And <span class="token punctuation">{</span>@Key in_keys<span class="token punctuation">(</span>@M<span class="token punctuation">)</span> #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

<span class="token comment">/*
// The rule below is automatically generated by the frontend for every sort
// hooked to MAP.Map. It is left here to serve as documentation.

  rule #Ceil(@M:Map (@K:KItem |-&gt; @V:KItem)) =&gt; {(@K in_keys(@M)) #Equals false} #And #Ceil(@M) #And #Ceil(@K) #And #Ceil(@V)
    [simplification]
*/</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> MAP<span class="token operator">-</span>SYMBOLIC
  <span class="token keyword">imports</span> MAP<span class="token operator">-</span>KORE<span class="token operator">-</span>SYMBOLIC
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="range-maps">Range Maps</h2>
<p>Provided here is the syntax of an implementation of immutable, associative,
commutative range maps from <code>Int</code> to <code>KItem</code>. This type is hooked to an
implementation of range maps provided by the LLVM backend.
Currently, this type is not supported by other backends.
Although the underlying range map data structure supports any key sort, the
current implementation by the backend only supports <code>Int</code> keys due to
limitations of the underlying ordering function.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> RANGEMAP
  <span class="token keyword">imports</span> private BOOL<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private INT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private LIST
  <span class="token keyword">imports</span> private SET

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="range%2C-bounded-inclusively-below-and-exclusively-above.">Range, bounded inclusively below and exclusively above.</h3>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Range <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"["</span> KItem <span class="token string">","</span> KItem <span class="token string">")"</span>    <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>RangeMap<span class="token punctuation">:</span>Range<span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token keyword">syntax</span> RangeMap <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>RangeMap<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="range-map-concatenation">Range map concatenation</h3>
<p>The <code>RangeMap</code> sort represents a map whose keys are stored as ranges, bounded
inclusively below and exclusively above. Contiguous or overlapping ranges that
map to the same value are merged into a single range.</p>
<p>You can construct a new <code>RangeMap</code> consisting of range/value pairs of two
RangeMaps. If the RangeMaps have overlapping ranges an exception will be
thrown during concrete execution. This operation is O(N*log(M)) (where N is
the size of the smaller map and M is the size of the larger map).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> RangeMap <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> RangeMap RangeMap                        <span class="token punctuation">[</span><span class="token class-name">left</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>concat<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_RangeMap_<span class="token punctuation">)</span><span class="token punctuation">,</span> assoc<span class="token punctuation">,</span> comm<span class="token punctuation">,</span> unit<span class="token punctuation">(</span><span class="token punctuation">.</span>RangeMap<span class="token punctuation">)</span><span class="token punctuation">,</span> element<span class="token punctuation">(</span>_r<span class="token operator">|</span><span class="token operator">-</span>&gt;_<span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">format</span><span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">1</span><span class="token operator">%</span>n<span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-unit">Range map unit</h3>
<p>The <code>RangeMap</code> with zero elements is represented by <code>.RangeMap</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> RangeMap <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">".RangeMap"</span>                         <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>unit<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span><span class="token punctuation">.</span>RangeMap<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-elements">Range map elements</h3>
<p>An element of a <code>RangeMap</code> is constructed via the <code>r|-&gt;</code> operator. The range
of keys is on the left, and the value is on the right.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> RangeMap <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Range <span class="token string">"r|-&gt;"</span> KItem                      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>elementRng<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_r<span class="token operator">|</span><span class="token operator">-</span>&gt;_<span class="token punctuation">)</span><span class="token punctuation">,</span> injective<span class="token punctuation">]</span>

  <span class="token keyword">syntax priority</span> _r<span class="token operator">|</span><span class="token operator">-</span>&gt;_ &gt; _RangeMap_ <span class="token punctuation">.</span>RangeMap
  <span class="token keyword">syntax non-assoc</span> _r<span class="token operator">|</span><span class="token operator">-</span>&gt;_
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="range-map-lookup">Range map lookup</h3>
<p>You can look up the value associated with a key of a <code>RangeMap</code> in O(log(N))
time (where N is the size of the <code>RangeMap</code>). This will yield an exception
during concrete execution if the key is not in the range map.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> RangeMap <span class="token string">"["</span> KItem <span class="token string">"]"</span>                    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>lookup<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>RangeMap<span class="token punctuation">:</span>lookup<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-lookup-with-default">Range map lookup with default</h3>
<p>You can also look up the value associated with a key of a <code>RangeMap</code> using a
total function that assigns a specific default value if the key is not present
in the <code>RangeMap</code>. This operation is also O(log(N)) (where N is the size of
the range map).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> RangeMap <span class="token string">"["</span> KItem <span class="token string">"]"</span> <span class="token string">"orDefault"</span> KItem      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>lookupOrDefault<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>RangeMap<span class="token punctuation">:</span>lookupOrDefault<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-lookup-for-range-of-key">Range map lookup for range of key</h3>
<p>You can look up for the range that a key of a <code>RangeMap</code> is stored in in
O(log(N)) time (where N is the size of the <code>RangeMap</code>). This will yield an
exception during concrete execution if the key is not in the range map.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Range <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"find_range"</span> <span class="token string">"("</span> RangeMap <span class="token string">","</span> KItem <span class="token string">")"</span>                    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>find_range<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>RangeMap<span class="token punctuation">:</span>find_range<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-update">Range map update</h3>
<p>You can insert a range/value pair into a <code>RangeMap</code> in O(log(N)) time (where N
is the size of the <code>RangeMap</code>). Any ranges adjacent to or overlapping with the
range to be inserted will be updated accordingly.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> RangeMap <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> RangeMap <span class="token string">"["</span> keyRange<span class="token punctuation">:</span> Range <span class="token string">"&lt;-"</span> value<span class="token punctuation">:</span> KItem <span class="token string">"]"</span>           <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>RangeMap<span class="token punctuation">:</span>update<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>updateRng<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">prefer</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-delete">Range map delete</h3>
<p>You can remove a range/value pair from a <code>RangeMap</code> in O(log(N)) time (where N
is the size of the <code>RangeMap</code>). If all or any part of the range is present in
the range map, it will be removed.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> RangeMap <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> RangeMap <span class="token string">"["</span> Range <span class="token string">"&lt;-"</span> <span class="token string">"undef"</span> <span class="token string">"]"</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>removeRng<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_r<span class="token punctuation">[</span>_&lt;<span class="token operator">-</span>undef<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-difference">Range map difference</h3>
<p>You can remove the range/value pairs in a <code>RangeMap</code> that are also present in
another <code>RangeMap</code> in O(max{M,N}*log(M)) time (where M is the size of the
first <code>RangeMap</code> and N is the size of the second <code>RangeMap</code>). Note that only
the parts of overlapping ranges whose value is the same in both range maps
will be removed.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> RangeMap <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> RangeMap <span class="token string">"-RangeMap"</span> RangeMap                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>difference<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="multiple-range-map-update">Multiple range map update</h3>
<p>You can update a <code>RangeMap</code> by adding all the range/value pairs in the second
<code>RangeMap</code> in O(N*log(M+N)) time (where M is the size of the first <code>RangeMap</code>
and N is the size of the second <code>RangeMap</code>). If any ranges are overlapping,
the value from the second range map overwrites the value in the first for the
parts where ranges are overlapping. This function is total, which is distinct
from range map concatenation, a partial function only defined on range maps
with non overlapping ranges.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> RangeMap <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> updateRangeMap<span class="token punctuation">(</span>RangeMap<span class="token punctuation">,</span> RangeMap<span class="token punctuation">)</span>            <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>updateAll<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="multiple-range-map-removal">Multiple range map removal</h3>
<p>You can remove a <code>Set</code> of ranges from a <code>RangeMap</code> in O(N*log(M)) time (where
M is the size of the <code>RangeMap</code> and N is the size of the <code>Set</code>). For every
range in the set, all or any part of it that is present in the range map will
be removed.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> RangeMap <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> removeAll<span class="token punctuation">(</span>RangeMap<span class="token punctuation">,</span> Set<span class="token punctuation">)</span>            <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>removeAll<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-keys-(as-set)">Range map keys (as <code>Set</code>)</h3>
<p>You can get a <code>Set</code> of all the ranges in a <code>RangeMap</code> in O(N) time (where N
is the size of the <code>RangeMap</code>).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> keys<span class="token punctuation">(</span>RangeMap<span class="token punctuation">)</span>                      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>keys<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-keys-(as-list)">Range map keys (as <code>List</code>)</h3>
<p>You can get a <code>List</code> of all the ranges in a <code>RangeMap</code> in O(N) time (where N
is the size of the <code>RangeMap</code>).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"keys_list"</span> <span class="token string">"("</span> RangeMap <span class="token string">")"</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>keys_list<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-key-membership">Range map key membership</h3>
<p>You can check whether a key is present in a <code>RangeMap</code> in O(log(N)) time (where
N is the size of the <code>RangeMap</code>).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> KItem <span class="token string">"in_keys"</span> <span class="token string">"("</span> RangeMap <span class="token string">")"</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>in_keys<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-values-(as-list)">Range map values (as <code>List</code>)</h3>
<p>You can get a <code>List</code> of all values in a <code>RangeMap</code> in O(N) time (where N is the
size of the <code>RangeMap</code>).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> values<span class="token punctuation">(</span>RangeMap<span class="token punctuation">)</span>                   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-size">Range map size</h3>
<p>You can get the number of range/value pairs in a <code>RangeMap</code> in O(1) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> size<span class="token punctuation">(</span>RangeMap<span class="token punctuation">)</span>                      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>sizeRangeMap<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-inclusion">Range map inclusion</h3>
<p>You can determine whether a <code>RangeMap</code> is a strict subset of another <code>RangeMap</code>
in O(M+N) time (where M is the size of the first <code>RangeMap</code> and N is the size
of the second <code>RangeMap</code>). Only keys within equal or overlapping ranges that
are bound to the same value are considered equal.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> RangeMap <span class="token string">"&lt;=RangeMap"</span> RangeMap               <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>inclusion<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="range-map-choice">Range map choice</h3>
<p>You can get an arbitrarily chosen key of a <code>RangeMap</code> in O(1) time. The same
key will always be returned for the same range map, but no guarantee is given
that two different range maps will return the same element, even if they are
similar.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> choice<span class="token punctuation">(</span>RangeMap<span class="token punctuation">)</span>                      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>RANGEMAP<span class="token punctuation">.</span>choice<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>RangeMap<span class="token punctuation">:</span>choice<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2 id="sets">Sets</h2>
<p>Provided here is the syntax of an implementation of immutable, associative,
commutative sets of <code>KItem</code>. This type is hooked to an implementation of sets
provided by the backend. For more information on matching on sets and allowable
patterns for doing so, refer to K's
<a href="../USER_MANUAL/">user documentation</a>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> SET
  <span class="token keyword">imports</span> private INT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private BASIC<span class="token operator">-</span>K

  <span class="token keyword">syntax</span> Set <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>Set<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="set-concatenation">Set concatenation</h3>
<p>The <code>Set</code> sort represents a mathematical set (A collection of unique items).
The sets are nilpotent, i.e., the concatenation of two sets containing elements
in common is <code>#False</code> (note however, this may be silently allowed during
concrete execution). If you intend to add an element to a set that might
already be present in the set, use the <code>|Set</code> operator instead.</p>
<p>The concatenation operator is O(N<em>log(M)) where N is the size of the smaller
set, when it appears on the right hand side. When it appears on the left hand
side and all variables are bound, it is O(N</em>log(M)) where M is the size of the
set it is matching and N is the number of elements being matched. When it
appears on the left hand side containing variables not bound elsewhere in the
term, it is O(N^K) where N is the size of the set it is matching and K is the
number of unbound keys being mached. In other words, one unbound variable is
linear, two is quadratic, three is cubic, etc.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Set Set                  <span class="token punctuation">[</span><span class="token class-name">left</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>concat<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_Set_<span class="token punctuation">)</span><span class="token punctuation">,</span> assoc<span class="token punctuation">,</span> comm<span class="token punctuation">,</span> unit<span class="token punctuation">(</span><span class="token punctuation">.</span>Set<span class="token punctuation">)</span><span class="token punctuation">,</span> idem<span class="token punctuation">,</span> element<span class="token punctuation">(</span>SetItem<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">format</span><span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">1</span><span class="token operator">%</span>n<span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="set-unit">Set unit</h3>
<p>The set with zero elements is represented by <code>.Set</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">".Set"</span>                   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>unit<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span><span class="token punctuation">.</span>Set<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="set-elements">Set elements</h3>
<p>An element of a <code>Set</code> is constructed via the <code>SetItem</code> operator.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> SetItem<span class="token punctuation">(</span>KItem<span class="token punctuation">)</span>               <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>element<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>SetItem<span class="token punctuation">)</span><span class="token punctuation">,</span> injective<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="set-union">Set union</h3>
<p>You can compute the union of two sets in O(N*log(M)) time (Where N is the size
of the smaller set). Note that the base of the logarithm is a relatively high
number and thus the time is effectively linear. The union consists of all the
elements present in either set.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Set <span class="token string">"|Set"</span> Set              <span class="token punctuation">[</span><span class="token class-name">left</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>union<span class="token punctuation">)</span><span class="token punctuation">,</span> comm<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> S1<span class="token punctuation">:</span>Set <span class="token operator">|</span>Set S2<span class="token punctuation">:</span>Set <span class="token operator">=&gt;</span> S1 <span class="token punctuation">(</span>S2 <span class="token operator">-</span>Set S1<span class="token punctuation">)</span> <span class="token punctuation">[</span>concrete<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="set-intersection">Set intersection</h3>
<p>You can compute the intersection of two sets in O(N*log(M)) time (where N
is the size of the smaller set), or effectively linear. The intersection
consists of all the elements present in both sets.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> intersectSet<span class="token punctuation">(</span>Set<span class="token punctuation">,</span> Set<span class="token punctuation">)</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>intersection<span class="token punctuation">)</span><span class="token punctuation">,</span> comm<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="set-complement">Set complement</h3>
<p>You can compute the relative complement of two sets in O(N*log(M)) time (where
N is the size of the second set), or effectively linear. This is the set of
elements in the first set that are not present in the second set.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Set <span class="token string">"-Set"</span> Set           <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>difference<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>Set<span class="token punctuation">:</span>difference<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="set-membership">Set membership</h3>
<p>You can compute whether an element is a member of a set in O(1) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> KItem <span class="token string">"in"</span> Set              <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>Set<span class="token punctuation">:</span>in<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="set-inclusion">Set inclusion</h3>
<p>You can determine whether a <code>Set</code> is a strict subset of another <code>Set</code> in O(N)
time (where N is the size of the first set).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Set <span class="token string">"&lt;=Set"</span> Set         <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>inclusion<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="set-size">Set size</h3>
<p>You can get the number of elements (the cardinality) of a set in O(1) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> size<span class="token punctuation">(</span>Set<span class="token punctuation">)</span>                <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="set-choice">Set choice</h3>
<p>You can get an arbitrarily chosen element of a <code>Set</code> in O(1) time. The same
element will always be returned for the same set, but no guarantee is given
that two different sets will return the same element, even if they are similar.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> choice<span class="token punctuation">(</span>Set<span class="token punctuation">)</span>                <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>choice<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>Set<span class="token punctuation">:</span>choice<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="implementation-of-sets">Implementation of Sets</h3>
<p>The following lemmas are simplifications that the Haskell backend can
apply to simplify expressions of sort <code>Set</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> SET<span class="token operator">-</span>KORE<span class="token operator">-</span>SYMBOLIC <span class="token punctuation">[</span>symbolic<span class="token punctuation">,</span>haskell<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> SET
  <span class="token keyword">imports</span> private K<span class="token operator">-</span>EQUAL
  <span class="token keyword">imports</span> private BOOL

  <span class="token comment">//Temporarly rule for #Ceil simplification, should be generated in front-end</span>

<span class="token comment">// Matching for this version not implemented.</span>
  <span class="token comment">// rule #Ceil(@S1:Set @S2:Set) =&gt;</span>
  <span class="token comment">//        {intersectSet(@S1, @S2) #Equals .Set} #And #Ceil(@S1) #And #Ceil(@S2)</span>
  <span class="token comment">//   [simplification]</span>

<span class="token comment">//simpler version</span>
  <span class="token keyword">rule</span> #Ceil<span class="token punctuation">(</span>@S<span class="token punctuation">:</span>Set SetItem<span class="token punctuation">(</span>@E<span class="token punctuation">:</span>KItem<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
         <span class="token punctuation">{</span><span class="token punctuation">(</span>@E in @S<span class="token punctuation">)</span> #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> #And #Ceil<span class="token punctuation">(</span>@S<span class="token punctuation">)</span> #And #Ceil<span class="token punctuation">(</span>@E<span class="token punctuation">)</span>
    <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token comment">// -Set simplifications</span>
  <span class="token keyword">rule</span> S              <span class="token operator">-</span>Set <span class="token punctuation">.</span>Set           <span class="token operator">=&gt;</span> S          <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">.</span>Set           <span class="token operator">-</span>Set  _             <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Set       <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span>     <span class="token operator">-</span>Set <span class="token punctuation">(</span>S SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Set
                               ensures notBool <span class="token punctuation">(</span>X in S<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> S              <span class="token operator">-</span>Set <span class="token punctuation">(</span>S SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Set
                               ensures notBool <span class="token punctuation">(</span>X in S<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>S SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span>Set S              <span class="token operator">=&gt;</span> SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
                               ensures notBool <span class="token punctuation">(</span>X in S<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>S SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span>Set SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> S
                               ensures notBool <span class="token punctuation">(</span>X in S<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token comment">// rule SetItem(X)     -Set S              =&gt; SetItem(X)</span>
  <span class="token comment">//                            requires notBool (X in S)  [simplification]</span>
  <span class="token comment">// rule (S1 SetItem(X)) -Set (S2 SetItem(X))  =&gt; S1 -Set S2</span>
  <span class="token comment">//                             ensures notBool (X in S1)</span>
  <span class="token comment">//                             andBool notBool (X in S2) [simplification]</span>



  <span class="token comment">// |Set simplifications</span>
  <span class="token keyword">rule</span> S    <span class="token operator">|</span>Set <span class="token punctuation">.</span>Set <span class="token operator">=&gt;</span> S    <span class="token punctuation">[</span>simplification<span class="token punctuation">,</span> comm<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> S    <span class="token operator">|</span>Set S    <span class="token operator">=&gt;</span> S    <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token punctuation">(</span>S SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>Set SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> S SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
                             ensures notBool <span class="token punctuation">(</span>X in S<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">,</span> comm<span class="token punctuation">]</span>
  <span class="token comment">// Currently disabled, see runtimeverification/haskell-backend#3301</span>
  <span class="token comment">// rule (S SetItem(X)) |Set S          =&gt; S SetItem(X)</span>
  <span class="token comment">//                            ensures notBool (X in S) [simplification, comm]</span>

  <span class="token comment">// intersectSet simplifications</span>
  <span class="token keyword">rule</span> intersectSet<span class="token punctuation">(</span><span class="token punctuation">.</span>Set<span class="token punctuation">,</span> _   <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Set    <span class="token punctuation">[</span>simplification<span class="token punctuation">,</span> comm<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> intersectSet<span class="token punctuation">(</span> S  <span class="token punctuation">,</span> S   <span class="token punctuation">)</span> <span class="token operator">=&gt;</span>  S      <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> intersectSet<span class="token punctuation">(</span> S SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
                                                        ensures notBool <span class="token punctuation">(</span>X in S<span class="token punctuation">)</span>      <span class="token punctuation">[</span>simplification<span class="token punctuation">,</span> comm<span class="token punctuation">]</span>
  <span class="token comment">// Currently disabled, see runtimeverification/haskell-backend#3294</span>
  <span class="token comment">// rule intersectSet( S SetItem(X) , S)             =&gt; S ensures notBool (X in S)      [simplification, comm]</span>
  <span class="token keyword">rule</span> intersectSet<span class="token punctuation">(</span> S1 SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> S2 SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> intersectSet<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> S2<span class="token punctuation">)</span> SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
                                                        ensures notBool <span class="token punctuation">(</span>X in S1<span class="token punctuation">)</span>
                                                        andBool notBool <span class="token punctuation">(</span>X in S2<span class="token punctuation">)</span>     <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token comment">// membership simplifications</span>
  <span class="token keyword">rule</span> _E in <span class="token punctuation">.</span>Set           <span class="token operator">=&gt;</span> <span class="token boolean">false</span>   <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> E  in <span class="token punctuation">(</span>S SetItem<span class="token punctuation">(</span>E<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
              ensures notBool <span class="token punctuation">(</span>E in S<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

<span class="token comment">// These two rules would be sound but impose a giant overhead on `in` evaluation:</span>
  <span class="token comment">// rule E1 in (S SetItem(E2)) =&gt; true requires E1 in S</span>
  <span class="token comment">//                                 ensures notBool (E2 in S) [simplification]</span>
  <span class="token comment">// rule E1 in (S SetItem(E2)) =&gt; E1 in S requires E1 =/=K E2</span>
  <span class="token comment">//                                 ensures notBool (E2 in S) [simplification]</span>

  <span class="token keyword">rule</span> X in <span class="token punctuation">(</span><span class="token punctuation">(</span>SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span> S<span class="token punctuation">)</span> <span class="token operator">|</span>Set  _            <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
                                    ensures notBool <span class="token punctuation">(</span>X in S<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> X in <span class="token punctuation">(</span> _             <span class="token operator">|</span>Set <span class="token punctuation">(</span>SetItem<span class="token punctuation">(</span>X<span class="token punctuation">)</span> S<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
                                    ensures notBool <span class="token punctuation">(</span>X in S<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> SET<span class="token operator">-</span>SYMBOLIC
  <span class="token keyword">imports</span> SET<span class="token operator">-</span>KORE<span class="token operator">-</span>SYMBOLIC
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="lists">Lists</h2>
<p>Provided here is the syntax of an implementation of immutable, associative
lists of <code>KItem</code>. This type is hooked to an implementation of lists provided
by the backend. For more information on matching on lists and allowable
patterns for doing so, refer to K's
<a href="../USER_MANUAL/">user documentation</a>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> LIST
  <span class="token keyword">imports</span> private INT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private MINT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private BASIC<span class="token operator">-</span>K

  <span class="token keyword">syntax</span> List <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>List<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="list-concatenation">List concatenation</h3>
<p>The <code>List</code> sort is an ordered collection that may contain duplicate elements.
They are backed by relaxed radix balanced trees, which means that they support
efficiently adding elements to both sides of the list, concatenating two lists,
indexing, and updating elements.</p>
<p>The concatenation operator is O(log(N)) (where N is the size of the longer
list) when it appears on the right hand side. When it appears on the left hand
side, it is O(N), where N is the number of elements matched on the front and
back of the list.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> List List               <span class="token punctuation">[</span><span class="token class-name">left</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>concat<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_List_<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>smt_seq_concat<span class="token punctuation">)</span><span class="token punctuation">,</span> assoc<span class="token punctuation">,</span> unit<span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">)</span><span class="token punctuation">,</span> element<span class="token punctuation">(</span>ListItem<span class="token punctuation">)</span><span class="token punctuation">,</span> update<span class="token punctuation">(</span>List<span class="token punctuation">:</span>set<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">format</span><span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">1</span><span class="token operator">%</span>n<span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="list-unit">List unit</h3>
<p>The list with zero elements is represented by <code>.List</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">".List"</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>unit<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>smt_seq_nil<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="list-elements">List elements</h3>
<p>An element of a <code>List</code> is constucted via the <code>ListItem</code> operator.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> ListItem<span class="token punctuation">(</span>KItem<span class="token punctuation">)</span>             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>element<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>ListItem<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>smt_seq_elem<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="list-prepend">List prepend</h3>
<p>An element can be added to the front of a <code>List</code> using the <code>pushList</code> operator.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> pushList<span class="token punctuation">(</span>KItem<span class="token punctuation">,</span> List<span class="token punctuation">)</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>push<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>pushList<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">rule</span> pushList<span class="token punctuation">(</span>K<span class="token punctuation">:</span><span class="token punctuation">:</span>KItem<span class="token punctuation">,</span> L1<span class="token punctuation">:</span><span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ListItem<span class="token punctuation">(</span>K<span class="token punctuation">)</span> L1
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="list-indexing">List indexing</h3>
<p>You can get an element of a list by its integer offset in O(log(N)) time, or
effectively constant. Positive <code>Int</code> indices are 0-indexed from the beginning of the
list, and negative indices are -1-indexed from the end of the list. In other
words, 0 is the first element and -1 is the last element. The indice can also be
<code>MInt</code>, which is interprested as an unsigned integer, and therefore, don't support
negative indices feature. Currently, only 64-bit and 256-bit <code>MInt</code> types are supported.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> List <span class="token string">"["</span> <span class="token keyword">Int</span> <span class="token string">"]"</span>           <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>get<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>List<span class="token punctuation">:</span>get<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> List <span class="token string">"["</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>getMInt<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>List<span class="token punctuation">:</span>getMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="list-update">List update</h3>
<p>You can create a new <code>List</code> with a new value at a particular index in
O(log(N)) time, or effectively constant. The index can be either as an <code>Int</code> or as an <code>MInt</code>. Currently, only 64-bit <code>MInt</code> type is supported.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> List <span class="token string">"["</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">"&lt;-"</span> value<span class="token punctuation">:</span> KItem <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>update<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>List<span class="token punctuation">:</span>set<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> List <span class="token string">"["</span> index<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&lt;-"</span> value<span class="token punctuation">:</span> KItem <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>updateMInt<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>List<span class="token punctuation">:</span>setMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="list-of-identical-elements">List of identical elements</h3>
<p>You can create a list with <code>length</code> elements, each containing <code>value</code>, in O(N)
time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> makeList<span class="token punctuation">(</span>length<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> KItem<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>make<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="multiple-list-update">Multiple list update</h3>
<p>You can create a new <code>List</code> which is equal to <code>dest</code> except the <code>N</code> elements
starting at <code>index</code> are replaced with the contents of <code>src</code> in O(N*log(K)) time
(where <code>K</code> is the size of <code>dest</code>and <code>N</code> is the size of <code>src</code>), or effectively linear. Having <code>index + N &gt; K</code> yields an exception.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> updateList<span class="token punctuation">(</span>dest<span class="token punctuation">:</span> List<span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> src<span class="token punctuation">:</span> List<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>updateAll<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="list-fill">List fill</h3>
<p>You can create a new <code>List</code> where the <code>length</code> elements starting at <code>index</code>
are replaced with <code>value</code>, in O(length*log(N)) time, or effectively linear.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> fillList<span class="token punctuation">(</span>List<span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> KItem<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>fill<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="list-slicing">List slicing</h3>
<p>You can compute a new <code>List</code> by removing <code>fromFront</code> elements from the front
of the list and <code>fromBack</code> elements from the back of the list in
O((fromFront+fromBack)*log(N)) time, or effectively linear.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> range<span class="token punctuation">(</span>List<span class="token punctuation">,</span> fromFront<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> fromBack<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>range<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>List<span class="token punctuation">:</span>range<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="list-membership">List membership</h3>
<p>You can compute whether an element is in a list in O(N) time. For repeated
comparisons, it is much better to first convert to a set using <code>List2Set</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> KItem <span class="token string">"in"</span> List             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_inList_<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="list-size">List size</h3>
<p>You can get the number of elements of a list in O(1) time. The output
size can be either as an <code>Int</code> or as an <code>MInt</code>. Currently, only 64-bit
and 256-bit <code>MInt</code> types are supported. When using <code>MInt</code>, the size is
interpreted as an unsigned integer, and the size of the list must match
the bounds of this <code>MInt</code> type, that is the size can't be larger than
<code>2^64 - 1</code> for <code>MInt{64}</code> and <code>2^256 - 1</code> for <code>MInt{256}</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> size<span class="token punctuation">(</span>List<span class="token punctuation">)</span>               <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>sizeList<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>smt_seq_len<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> size<span class="token punctuation">(</span>List<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>LIST<span class="token punctuation">.</span>sizeMInt<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>sizeMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="collection-conversions">Collection Conversions</h2>
<p>It is possible to convert from a <code>List</code> to a <code>Set</code> or from a <code>Set</code> to a list.
Converting from a <code>List</code> to a <code>Set</code> and back will not provide the same list;
duplicates will have been removed and the list may be reordered. Converting
from a <code>Set</code> to a <code>List</code> and back will generate the same set.</p>
<p>Note that because sets are unordered and lists are ordered, converting from a
Set to a List will generate some arbitrary ordering of elements, which may
be different from the natural ordering you might assume, or may not. Two
equal sets are guaranteed to generate the same ordering, but no guarantee is
otherwise provided about what the ordering will be. In particular, adding an
element to a set may completely reorder the elements already in the set, when
it is converted to a list.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> COLLECTIONS
  <span class="token keyword">imports</span> LIST
  <span class="token keyword">imports</span> SET
  <span class="token keyword">imports</span> MAP

  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Set2List<span class="token punctuation">(</span>Set<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>set2list<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> List2Set<span class="token punctuation">(</span>List<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>SET<span class="token punctuation">.</span>list2set<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="booleans">Booleans</h2>
<p>Provided here is the syntax of an implementation of boolean algebra in K.
This type is hooked to an implementation of booleans provided by the backend.
Note that this algebra is different from the builtin truth in matching logic.
You can, however, convert from the truth of the <code>Bool</code> sort to the truth in
matching logic via the expression <code>{B #Equals true}</code>.</p>
<p>The boolean values are <code>true</code> and <code>false</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> SORT<span class="token operator">-</span>BOOL
  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span><span class="token keyword">Bool</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> BOOL<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> SORT<span class="token operator">-</span>BOOL
  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"true"</span>  <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"false"</span> <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> BOOL<span class="token operator">-</span>COMMON
  <span class="token keyword">imports</span> private BASIC<span class="token operator">-</span>K
  <span class="token keyword">imports</span> BOOL<span class="token operator">-</span>SYNTAX
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="basic-boolean-arithmetic">Basic boolean arithmetic</h3>
<p>You can:</p>
<ul>
<li>Negate a boolean value.</li>
<li>AND two boolean values.</li>
<li>XOR two boolean values.</li>
<li>OR two boolean values.</li>
<li>IMPLIES two boolean values (i.e., <code>P impliesBool Q</code> is the same as
<code>notBool P orBool Q</code>)</li>
<li>Check equality of two boolean values.</li>
<li>Check inequality of two boolean values.</li>
</ul>
<p>Note that only <code>andThenBool</code> and <code>orElseBool</code> are short-circuiting. <code>andBool</code>
and <code>orBool</code> may be short-circuited in concrete backends, but in symbolic
backends, both arguments will be evaluated.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"notBool"</span> <span class="token keyword">Bool</span>          <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>notBool_<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>not<span class="token punctuation">)</span><span class="token punctuation">,</span> group<span class="token punctuation">(</span>boolOperation<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span>not<span class="token punctuation">)</span><span class="token punctuation">]</span>
                &gt; <span class="token keyword">Bool</span> <span class="token string">"andBool"</span> <span class="token keyword">Bool</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_andBool_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>and<span class="token punctuation">)</span><span class="token punctuation">,</span> group<span class="token punctuation">(</span>boolOperation<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span>and<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Bool</span> <span class="token string">"andThenBool"</span> <span class="token keyword">Bool</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_andThenBool_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>and<span class="token punctuation">)</span><span class="token punctuation">,</span> group<span class="token punctuation">(</span>boolOperation<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span>andThen<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Bool</span> <span class="token string">"xorBool"</span> <span class="token keyword">Bool</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_xorBool_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>xor<span class="token punctuation">)</span><span class="token punctuation">,</span> group<span class="token punctuation">(</span>boolOperation<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span>xor<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Bool</span> <span class="token string">"orBool"</span> <span class="token keyword">Bool</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_orBool_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>or<span class="token punctuation">)</span><span class="token punctuation">,</span> group<span class="token punctuation">(</span>boolOperation<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span>or<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Bool</span> <span class="token string">"orElseBool"</span> <span class="token keyword">Bool</span>  <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_orElseBool_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>or<span class="token punctuation">)</span><span class="token punctuation">,</span> group<span class="token punctuation">(</span>boolOperation<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span>orElse<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Bool</span> <span class="token string">"impliesBool"</span> <span class="token keyword">Bool</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_impliesBool_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">=&gt;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> group<span class="token punctuation">(</span>boolOperation<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span>implies<span class="token punctuation">)</span><span class="token punctuation">]</span>
                &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                  <span class="token keyword">Bool</span> <span class="token string">"==Bool"</span> <span class="token keyword">Bool</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">==</span>Bool_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">=</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span>eq<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Bool</span> <span class="token string">"=/=Bool"</span> <span class="token keyword">Bool</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>Bool_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>distinct<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BOOL<span class="token punctuation">.</span>ne<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="implementation-of-booleans">Implementation of Booleans</h3>
<p>The remainder of this section consists of an implementation in K of the
operations listed above.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">rule</span> notBool <span class="token boolean">true</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span>
  <span class="token keyword">rule</span> notBool <span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>

  <span class="token keyword">rule</span> <span class="token boolean">true</span> andBool B<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> B<span class="token punctuation">:</span><span class="token keyword">Bool</span>
  <span class="token keyword">rule</span> B<span class="token punctuation">:</span><span class="token keyword">Bool</span> andBool <span class="token boolean">true</span> <span class="token operator">=&gt;</span> B<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token boolean">false</span> andBool _<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span>
  <span class="token keyword">rule</span> _<span class="token punctuation">:</span><span class="token keyword">Bool</span> andBool <span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token boolean">true</span> andThenBool K<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> K
  <span class="token keyword">rule</span> K<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Bool</span> andThenBool <span class="token boolean">true</span> <span class="token operator">=&gt;</span> K <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token boolean">false</span> andThenBool _ <span class="token operator">=&gt;</span> <span class="token boolean">false</span>
  <span class="token keyword">rule</span> _ andThenBool <span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span>  <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token boolean">false</span> xorBool B<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> B<span class="token punctuation">:</span><span class="token keyword">Bool</span>
  <span class="token keyword">rule</span> B<span class="token punctuation">:</span><span class="token keyword">Bool</span> xorBool <span class="token boolean">false</span> <span class="token operator">=&gt;</span> B<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> B<span class="token punctuation">:</span><span class="token keyword">Bool</span> xorBool B<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span>

  <span class="token keyword">rule</span> <span class="token boolean">true</span> orBool _<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
  <span class="token keyword">rule</span> _<span class="token punctuation">:</span><span class="token keyword">Bool</span> orBool <span class="token boolean">true</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token boolean">false</span> orBool B<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> B
  <span class="token keyword">rule</span> B<span class="token punctuation">:</span><span class="token keyword">Bool</span> orBool <span class="token boolean">false</span> <span class="token operator">=&gt;</span> B   <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token boolean">true</span> orElseBool _ <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
  <span class="token keyword">rule</span> _ orElseBool <span class="token boolean">true</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>     <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token boolean">false</span> orElseBool K<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> K
  <span class="token keyword">rule</span> K<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Bool</span> orElseBool <span class="token boolean">false</span> <span class="token operator">=&gt;</span> K <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token boolean">true</span> impliesBool B<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> B
  <span class="token keyword">rule</span> <span class="token boolean">false</span> impliesBool _<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
  <span class="token keyword">rule</span> _<span class="token punctuation">:</span><span class="token keyword">Bool</span> impliesBool <span class="token boolean">true</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>       <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> B<span class="token punctuation">:</span><span class="token keyword">Bool</span> impliesBool <span class="token boolean">false</span> <span class="token operator">=&gt;</span> notBool B <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> B1<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Bool</span> B2<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> notBool <span class="token punctuation">(</span>B1 <span class="token operator">==</span><span class="token keyword">Bool</span> B2<span class="token punctuation">)</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> BOOL<span class="token operator">-</span>KORE <span class="token punctuation">[</span>symbolic<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> BOOL<span class="token operator">-</span>COMMON

  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">true</span> #Equals notBool @B<span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals @B<span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>notBool @B #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>@B #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals notBool @B<span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token boolean">true</span> #Equals @B<span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>notBool @B #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>@B #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">true</span> #Equals @B1 andBool @B2<span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token boolean">true</span> #Equals @B1<span class="token punctuation">}</span> #And <span class="token punctuation">{</span><span class="token boolean">true</span> #Equals @B2<span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>@B1 andBool @B2 #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>@B1 #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> #And <span class="token punctuation">{</span>@B2 #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals @B1 orBool @B2<span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals @B1<span class="token punctuation">}</span> #And <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals @B2<span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>@B1 orBool @B2 #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>@B1 #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> #And <span class="token punctuation">{</span>@B2 #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> BOOL
  <span class="token keyword">imports</span> BOOL<span class="token operator">-</span>COMMON
  <span class="token keyword">imports</span> BOOL<span class="token operator">-</span>KORE
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="integers">Integers</h2>
<p>Provided here is the syntax of an implementation of arbitrary-precision
integer arithmetic in K. This type is hooked to an implementation of integers
provided by the backend. For a fixed-width integer type, see the <code>MINT</code> module
below.</p>
<p>The <code>UNSIGNED-INT-SYNTAX</code> module provides a syntax of whole numbers in K.
This is useful because often programming languages implement the sign of an
integer as a unary operator rather than part of the lexical syntax of integers.
However, you can also directly reference integers with a sign using the
<code>INT-SYNTAX</code> module.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> UNSIGNED<span class="token operator">-</span>INT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span><span class="token keyword">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> r<span class="token string">"[0-9]+"</span> <span class="token punctuation">[</span><span class="token class-name">prefer</span><span class="token punctuation">,</span> <span class="token class-name">token</span><span class="token punctuation">,</span> prec<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> INT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> UNSIGNED<span class="token operator">-</span>INT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> r<span class="token string">"[\\+\\-]?[0-9]+"</span> <span class="token punctuation">[</span><span class="token class-name">prefer</span><span class="token punctuation">,</span> <span class="token class-name">token</span><span class="token punctuation">,</span> prec<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> INT<span class="token operator">-</span>COMMON
  <span class="token keyword">imports</span> INT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private BOOL
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="integer-arithmetic">Integer arithmetic</h3>
<p>You can:</p>
<ul>
<li>Compute the bitwise complement <code>~Int</code> of an integer value in twos-complement.</li>
<li>Compute the exponentiation <code>^Int</code> of two integers.</li>
<li>Compute the exponentiation of two integers modulo another integer (<code>^%Int</code>).
<code>A ^%Int B C</code> is equal in value to <code>(A ^Int B) %Int C</code>, but has a better
asymptotic complexity.</li>
<li>Compute the product <code>*Int</code> of two integers.</li>
<li>Compute the quotient <code>/Int</code> or modulus <code>%Int</code> of two integers using
t-division, which rounds towards zero. Division by zero is <code>#False</code>.</li>
<li>Compute the quotient <code>divInt</code> or modulus <code>modInt</code> of two integers using
Euclidean division, in which the remainder is always non-negative. Division
by zero is <code>#False</code>.</li>
<li>Compute the sum <code>+Int</code> or difference <code>-Int</code> of two integers.</li>
<li>Compute the arithmetic right shift <code>&gt;&gt;Int</code> of two integers. Shifting by a
negative quantity is <code>#False</code>.</li>
<li>Compute the left shift of two integers. Shifting by a negative quantity is
<code>#False</code>.</li>
<li>Compute the bitwise and of two integers in twos-complement.</li>
<li>Compute the bitwise xor of two integers in twos-complement.</li>
<li>Compute the bitwise inclusive-or of two integers in twos-complement.</li>
</ul>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"~Int"</span> <span class="token keyword">Int</span>                     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span><span class="token operator">~</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>not<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>notInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                 <span class="token keyword">Int</span> <span class="token string">"^Int"</span> <span class="token keyword">Int</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">^</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>pow<span class="token punctuation">)</span><span class="token punctuation">]</span>
               <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"^%Int"</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>            <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">^</span><span class="token operator">%</span>Int__<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>mod <span class="token punctuation">(</span><span class="token operator">^</span> #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> #<span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>powmod<span class="token punctuation">)</span><span class="token punctuation">]</span>
               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                 <span class="token keyword">Int</span> <span class="token string">"*Int"</span> <span class="token keyword">Int</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">*</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>mul<span class="token punctuation">)</span><span class="token punctuation">]</span>
               <span class="token comment">/* FIXME: translate /Int and %Int into smtlib */</span>
               <span class="token comment">/* /Int and %Int implement t-division, which rounds towards 0. SMT hooks need to convert from Euclidian division operations */</span>
               <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"/Int"</span> <span class="token keyword">Int</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">/</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span>
                                                 smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>ite <span class="token punctuation">(</span>or <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">(</span>mod #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">&gt;=</span> #<span class="token number">1</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>div #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>ite <span class="token punctuation">(</span>&gt; #<span class="token number">2</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">+</span> <span class="token punctuation">(</span>div #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">-</span> <span class="token punctuation">(</span>div #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                 hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>tdiv<span class="token punctuation">)</span><span class="token punctuation">]</span>
               <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"%Int"</span> <span class="token keyword">Int</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">%</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span>
                                                 smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>ite <span class="token punctuation">(</span>or <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">(</span>mod #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">&gt;=</span> #<span class="token number">1</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>mod #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>ite <span class="token punctuation">(</span>&gt; #<span class="token number">2</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">-</span> <span class="token punctuation">(</span>mod #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> #<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">+</span> <span class="token punctuation">(</span>mod #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                 hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>tmod<span class="token punctuation">)</span><span class="token punctuation">]</span>
               <span class="token comment">/* divInt and modInt implement e-division according to the Euclidean division theorem, therefore the remainder is always positive */</span>
               <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"divInt"</span> <span class="token keyword">Int</span>               <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_divInt_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>ediv<span class="token punctuation">)</span><span class="token punctuation">]</span>
               <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"modInt"</span> <span class="token keyword">Int</span>               <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_modInt_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>mod<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>emod<span class="token punctuation">)</span><span class="token punctuation">]</span>
               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                 <span class="token keyword">Int</span> <span class="token string">"+Int"</span> <span class="token keyword">Int</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">+</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>add<span class="token punctuation">)</span><span class="token punctuation">]</span>
               <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"-Int"</span> <span class="token keyword">Int</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">-</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>sub<span class="token punctuation">)</span><span class="token punctuation">]</span>
               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                 <span class="token keyword">Int</span> <span class="token string">"&gt;&gt;Int"</span> <span class="token keyword">Int</span>                <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_&gt;&gt;Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>shr<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>shrInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
               <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"&lt;&lt;Int"</span> <span class="token keyword">Int</span>                <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_&lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Int_),</span> <span class="token attr-name">left,</span> <span class="token attr-name">hook(INT.shl),</span> <span class="token attr-name">smtlib(shlInt)]</span>
               <span class="token punctuation">&gt;</span></span> <span class="token class-name">left</span><span class="token punctuation">:</span>
                 <span class="token keyword">Int</span> <span class="token string">"&amp;Int"</span> <span class="token keyword">Int</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">&amp;</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> comm<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>and<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>andInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                 <span class="token keyword">Int</span> <span class="token string">"xorInt"</span> <span class="token keyword">Int</span>               <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_xorInt_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> comm<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>xor<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>xorInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                 <span class="token keyword">Int</span> <span class="token string">"|Int"</span> <span class="token keyword">Int</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">|</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> comm<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>or<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>orInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="integer-minimum-and-maximum">Integer minimum and maximum</h3>
<p>You can compute the minimum and maximum <code>minInt</code> and <code>maxInt</code> of two integers.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"minInt"</span> <span class="token string">"("</span> <span class="token keyword">Int</span> <span class="token string">","</span> <span class="token keyword">Int</span> <span class="token string">")"</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>ite <span class="token punctuation">(</span>&lt; #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>min<span class="token punctuation">)</span><span class="token punctuation">]</span>
               <span class="token operator">|</span> <span class="token string">"maxInt"</span> <span class="token string">"("</span> <span class="token keyword">Int</span> <span class="token string">","</span> <span class="token keyword">Int</span> <span class="token string">")"</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>ite <span class="token punctuation">(</span>&lt; #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> #<span class="token number">2</span> #<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>max<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="absolute-value">Absolute value</h3>
<p>You can compute the absolute value <code>absInt</code> of an integer.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> absInt <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>                 <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>ite <span class="token punctuation">(</span>&lt; #<span class="token number">1</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">-</span> <span class="token number">0</span> #<span class="token number">1</span><span class="token punctuation">)</span> #<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>abs<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="log-base-2">Log base 2</h3>
<p>You can compute the log base 2, rounded towards zero, of an integer. The log
base 2 of an integer is equal to the index of the highest bit set in the
representation of a positive integer. Log base 2 of zero or a negative number
is <code>#False</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> log2Int <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>                <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>log2<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="bit-slicing">Bit slicing</h3>
<p>You can compute the value of a range of bits in the twos-complement
representation of an integer, as interpeted either unsigned or signed, of an
integer. <code>index</code> is offset from 0 and <code>length</code> is the number of bits, starting
with <code>index</code>, that should be read. The number is assumed to be represented
in little endian notation with each byte going from least significant to
most significant. In other words, 0 is the least-significant bit, and each
successive bit is more significant than the last.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> bitRangeInt           <span class="token punctuation">(</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>bitRange<span class="token punctuation">)</span><span class="token punctuation">]</span>
               <span class="token operator">|</span> signExtendBitRangeInt <span class="token punctuation">(</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>signExtendBitRange<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="integer-comparisons">Integer comparisons</h3>
<p>You can compute whether two integers are less than or equal to, less than,
greater than or equal to, greater than, equal, or unequal to another integer.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">Int</span> <span class="token string">"&lt;=Int"</span> <span class="token keyword">Int</span>         <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">&lt;=</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">&lt;=</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>le<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"&lt;Int"</span> <span class="token keyword">Int</span>          <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Int_),</span> <span class="token attr-name">smt-hook(&lt;),</span> <span class="token attr-name">hook(INT.lt)]</span>
                <span class="token attr-name">|</span> <span class="token attr-name">Int</span> <span class="token attr-name">"</span><span class="token punctuation">&gt;</span></span><span class="token operator">=</span><span class="token keyword">Int</span>" <span class="token keyword">Int</span>         <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">&gt;=</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">&gt;=</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>ge<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"&gt;Int"</span> <span class="token keyword">Int</span>          <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_&gt;Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>&gt;<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>gt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"==Int"</span> <span class="token keyword">Int</span>         <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">==</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">=</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>eq<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Int</span> <span class="token string">"=/=Int"</span> <span class="token keyword">Int</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>Int_<span class="token punctuation">)</span><span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>distinct<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>ne<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="divides">Divides</h3>
<p>You can compute whether one integer evenly divides another. This is the
case when the second integer modulo the first integer is equal to zero.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">Int</span> <span class="token string">"dividesInt"</span> <span class="token keyword">Int</span>    <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="random-integers">Random integers</h3>
<p>You can, on concrete backends, compute a pseudorandom integer, or seed the
pseudorandom number generator. These operations are represented as
uninterpreted functions on symbolic backends.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> randInt<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>rand<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> srandInt<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>INT<span class="token punctuation">.</span>srand<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="implementation-of-integers">Implementation of Integers</h3>
<p>The remainder of this section consists of an implementation in K of some
of the operators above, as well as lemmas used  by the Java and Haskell backend
to simplify expressions of sort <code>Int</code>. They do not affect the semantics of
integers, merely describing additional rules that the backend can use to
simplify terms.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">endmodule</span>

<span class="token keyword">module</span> INT<span class="token operator">-</span>SYMBOLIC <span class="token punctuation">[</span>symbolic<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> INT<span class="token operator">-</span>COMMON
  <span class="token keyword">imports</span> INT<span class="token operator">-</span>SYMBOLIC<span class="token operator">-</span>KORE
  <span class="token keyword">imports</span> private BOOL

  <span class="token comment">// Arithmetic Normalization</span>
  <span class="token keyword">rule</span> I <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">0</span> <span class="token operator">=&gt;</span> I <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> I <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">0</span> <span class="token operator">=&gt;</span> I <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> X modInt N <span class="token operator">=&gt;</span> X <span class="token keyword">requires</span> <span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> X andBool X &lt;<span class="token keyword">Int</span> N <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> X   <span class="token operator">%</span><span class="token keyword">Int</span> N <span class="token operator">=&gt;</span> X <span class="token keyword">requires</span> <span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> X andBool X &lt;<span class="token keyword">Int</span> N <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token comment">// Bit-shifts</span>
  <span class="token keyword">rule</span> X &lt;&lt;<span class="token keyword">Int</span> <span class="token number">0</span> <span class="token operator">=&gt;</span> X                    <span class="token punctuation">[</span>simplification<span class="token punctuation">,</span> preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token number">0</span> &lt;&lt;<span class="token keyword">Int</span> Y <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token keyword">requires</span> <span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> Y <span class="token punctuation">[</span>simplification<span class="token punctuation">,</span> preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> X &gt;&gt;<span class="token keyword">Int</span> <span class="token number">0</span> <span class="token operator">=&gt;</span> X                    <span class="token punctuation">[</span>simplification<span class="token punctuation">,</span> preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token number">0</span> &gt;&gt;<span class="token keyword">Int</span> Y <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token keyword">requires</span> <span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> Y <span class="token punctuation">[</span>simplification<span class="token punctuation">,</span> preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> INT<span class="token operator">-</span>SYMBOLIC<span class="token operator">-</span>KORE <span class="token punctuation">[</span>symbolic<span class="token punctuation">,</span> haskell<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> INT<span class="token operator">-</span>COMMON
  <span class="token keyword">imports</span> ML<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private BOOL

  <span class="token comment">// Definability Conditions</span>
  <span class="token keyword">rule</span> #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token operator">/</span><span class="token keyword">Int</span>   @I2<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>@I2 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span><span class="token punctuation">)</span> #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> #And #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">)</span> #And #Ceil<span class="token punctuation">(</span>@I2<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token operator">%</span><span class="token keyword">Int</span>   @I2<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>@I2 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span><span class="token punctuation">)</span> #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> #And #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">)</span> #And #Ceil<span class="token punctuation">(</span>@I2<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">:</span><span class="token keyword">Int</span> modInt @I2<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>@I2 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span><span class="token punctuation">)</span> #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> #And #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">)</span> #And #Ceil<span class="token punctuation">(</span>@I2<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">:</span><span class="token keyword">Int</span> &gt;&gt;<span class="token keyword">Int</span>  @I2<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>@I2 <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">0</span><span class="token punctuation">)</span>  #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> #And #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">)</span> #And #Ceil<span class="token punctuation">(</span>@I2<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">:</span><span class="token keyword">Int</span> &lt;&lt;<span class="token keyword">Int</span>  @I2<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>@I2 <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">0</span><span class="token punctuation">)</span>  #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> #And #Ceil<span class="token punctuation">(</span>@I1<span class="token punctuation">)</span> #And #Ceil<span class="token punctuation">(</span>@I2<span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> INT<span class="token operator">-</span>KORE <span class="token punctuation">[</span>symbolic<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> private K<span class="token operator">-</span>EQUAL
  <span class="token keyword">imports</span> private BOOL
  <span class="token keyword">imports</span> INT<span class="token operator">-</span>COMMON

  <span class="token keyword">rule</span> <span class="token punctuation">[</span>eq<span class="token operator">-</span>k<span class="token operator">-</span>to<span class="token operator">-</span>eq<span class="token operator">-</span>int<span class="token punctuation">]</span>     <span class="token punctuation">:</span> I1<span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token operator">==</span>K I2<span class="token punctuation">:</span><span class="token keyword">Int</span>            <span class="token operator">=&gt;</span> I1 <span class="token operator">==</span><span class="token keyword">Int</span> I2           <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>eq<span class="token operator">-</span>int<span class="token operator">-</span><span class="token boolean">true</span><span class="token operator">-</span><span class="token class-name">left</span><span class="token punctuation">]</span>   <span class="token punctuation">:</span> <span class="token punctuation">{</span>K1 <span class="token operator">==</span><span class="token keyword">Int</span> K2 #Equals <span class="token boolean">true</span><span class="token punctuation">}</span>   <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span>       <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>eq<span class="token operator">-</span>int<span class="token operator">-</span><span class="token boolean">true</span><span class="token operator">-</span>rigth<span class="token punctuation">]</span>  <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token boolean">true</span> #Equals K1 <span class="token operator">==</span><span class="token keyword">Int</span> K2<span class="token punctuation">}</span>   <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span>       <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>eq<span class="token operator">-</span>int<span class="token operator">-</span><span class="token boolean">false</span><span class="token operator">-</span><span class="token class-name">left</span><span class="token punctuation">]</span>  <span class="token punctuation">:</span> <span class="token punctuation">{</span>K1 <span class="token operator">==</span><span class="token keyword">Int</span> K2 #Equals <span class="token boolean">false</span><span class="token punctuation">}</span>  <span class="token operator">=&gt;</span> #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>eq<span class="token operator">-</span>int<span class="token operator">-</span><span class="token boolean">false</span><span class="token operator">-</span>rigth<span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals K1 <span class="token operator">==</span><span class="token keyword">Int</span> K2<span class="token punctuation">}</span>  <span class="token operator">=&gt;</span> #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>neq<span class="token operator">-</span>int<span class="token operator">-</span><span class="token boolean">true</span><span class="token operator">-</span><span class="token class-name">left</span><span class="token punctuation">]</span>  <span class="token punctuation">:</span> <span class="token punctuation">{</span>K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> K2 #Equals <span class="token boolean">true</span><span class="token punctuation">}</span>  <span class="token operator">=&gt;</span> #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>neq<span class="token operator">-</span>int<span class="token operator">-</span><span class="token boolean">true</span><span class="token operator">-</span><span class="token class-name">right</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token boolean">true</span> #Equals K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> K2<span class="token punctuation">}</span>  <span class="token operator">=&gt;</span> #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>neq<span class="token operator">-</span>int<span class="token operator">-</span><span class="token boolean">false</span><span class="token operator">-</span><span class="token class-name">left</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> K2 #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span>       <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>neq<span class="token operator">-</span>int<span class="token operator">-</span><span class="token boolean">false</span><span class="token operator">-</span><span class="token class-name">right</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> K2<span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span>       <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

  <span class="token comment">// Arithmetic Normalization</span>
  <span class="token keyword">rule</span> I <span class="token operator">+</span><span class="token keyword">Int</span> B <span class="token operator">=&gt;</span> B <span class="token operator">+</span><span class="token keyword">Int</span> I          <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">(</span><span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">rule</span> A <span class="token operator">-</span><span class="token keyword">Int</span> I <span class="token operator">=&gt;</span> A <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">-</span><span class="token keyword">Int</span> I<span class="token punctuation">)</span> <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">(</span><span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token punctuation">(</span>A <span class="token operator">+</span><span class="token keyword">Int</span> I2<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> I3 <span class="token operator">=&gt;</span> A <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>I2 <span class="token operator">+</span><span class="token keyword">Int</span> I3<span class="token punctuation">)</span> <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I2<span class="token punctuation">,</span> I3<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> I1 <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>B <span class="token operator">+</span><span class="token keyword">Int</span> I3<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> B <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>I1 <span class="token operator">+</span><span class="token keyword">Int</span> I3<span class="token punctuation">)</span> <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I3<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> I1 <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>B <span class="token operator">+</span><span class="token keyword">Int</span> I3<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I1 <span class="token operator">-</span><span class="token keyword">Int</span> I3<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> B <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I3<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> I1 <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>I2 <span class="token operator">+</span><span class="token keyword">Int</span> C<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I1 <span class="token operator">+</span><span class="token keyword">Int</span> I2<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> C <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I2<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> I1 <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>I2 <span class="token operator">-</span><span class="token keyword">Int</span> C<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I1 <span class="token operator">+</span><span class="token keyword">Int</span> I2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> C <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I2<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>I1 <span class="token operator">-</span><span class="token keyword">Int</span> B<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> I3 <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I1 <span class="token operator">+</span><span class="token keyword">Int</span> I3<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> B <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I3<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> I1 <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>I2 <span class="token operator">+</span><span class="token keyword">Int</span> C<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I1 <span class="token operator">-</span><span class="token keyword">Int</span> I2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> C <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I2<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> I1 <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>I2 <span class="token operator">-</span><span class="token keyword">Int</span> C<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I1 <span class="token operator">-</span><span class="token keyword">Int</span> I2<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> C <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I2<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>C <span class="token operator">-</span><span class="token keyword">Int</span> I2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> I3 <span class="token operator">=&gt;</span> C <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>I2 <span class="token operator">+</span><span class="token keyword">Int</span> I3<span class="token punctuation">)</span> <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I2<span class="token punctuation">,</span> I3<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> I1 <span class="token operator">&amp;</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>I2 <span class="token operator">&amp;</span><span class="token keyword">Int</span> C<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I1 <span class="token operator">&amp;</span><span class="token keyword">Int</span> I2<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token keyword">Int</span> C <span class="token punctuation">[</span>concrete<span class="token punctuation">(</span>I1<span class="token punctuation">,</span> I2<span class="token punctuation">)</span><span class="token punctuation">,</span> symbolic<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> INT
  <span class="token keyword">imports</span> INT<span class="token operator">-</span>COMMON
  <span class="token keyword">imports</span> INT<span class="token operator">-</span>SYMBOLIC
  <span class="token keyword">imports</span> INT<span class="token operator">-</span>KORE
  <span class="token keyword">imports</span> private K<span class="token operator">-</span>EQUAL
  <span class="token keyword">imports</span> private BOOL

  <span class="token keyword">rule</span> bitRangeInt<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> LEN<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I &gt;&gt;<span class="token keyword">Int</span> IDX<span class="token punctuation">)</span> modInt <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> LEN<span class="token punctuation">)</span>

  <span class="token keyword">rule</span> signExtendBitRangeInt<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> IDX<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> LEN<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>bitRangeInt<span class="token punctuation">(</span>I<span class="token punctuation">,</span> IDX<span class="token punctuation">,</span> LEN<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> <span class="token punctuation">(</span>LEN <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> modInt <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> LEN<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> <span class="token punctuation">(</span>LEN <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword">rule</span> I1<span class="token punctuation">:</span><span class="token keyword">Int</span> divInt I2<span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I1 <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>I1 modInt I2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> I2
  <span class="token keyword">requires</span> I2 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span>
  <span class="token keyword">rule</span>
    I1<span class="token punctuation">:</span><span class="token keyword">Int</span> modInt I2<span class="token punctuation">:</span><span class="token keyword">Int</span>
  <span class="token operator">=&gt;</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span>I1 <span class="token operator">%</span><span class="token keyword">Int</span> absInt<span class="token punctuation">(</span>I2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> absInt<span class="token punctuation">(</span>I2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token keyword">Int</span> absInt<span class="token punctuation">(</span>I2<span class="token punctuation">)</span>
  <span class="token keyword">requires</span> I2 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span>    <span class="token punctuation">[</span>concrete<span class="token punctuation">,</span> simplification<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> minInt<span class="token punctuation">(</span>I1<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> I2<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> I1 <span class="token keyword">requires</span> I1 &lt;<span class="token keyword">Int</span>  I2
  <span class="token keyword">rule</span> minInt<span class="token punctuation">(</span>I1<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> I2<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> I2 <span class="token keyword">requires</span> I1 <span class="token operator">&gt;=</span><span class="token keyword">Int</span> I2

  <span class="token keyword">rule</span> I1<span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> I2<span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token operator">=&gt;</span> notBool <span class="token punctuation">(</span>I1 <span class="token operator">==</span><span class="token keyword">Int</span> I2<span class="token punctuation">)</span>
  <span class="token keyword">rule</span> <span class="token punctuation">(</span>I1<span class="token punctuation">:</span><span class="token keyword">Int</span> dividesInt I2<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>I2 <span class="token operator">%</span><span class="token keyword">Int</span> I1<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>

  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> freshInt<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>freshGenerator<span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> private<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> freshInt<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> I
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ieee-754-floating-point-numbers">IEEE 754 Floating-point Numbers</h2>
<p>Provided here is the syntax of an implementation of arbitrary-precision
floating-point arithmetic in K based on a generalization of the IEEE 754
standard. This type is hooked to an implementation of floats provided by the
backend.</p>
<p>The syntax of ordinary floating-point values in K consists of an optional sign
(+ or -) followed by an optional integer part, followed by a decimal point,
followed by an optional fractional part. Either the integer part or the
fractional part must be specified. The mantissa is followed by an optional
exponent part, which consists of an <code>e</code> or <code>E</code>, an optional sign (+ or -),
and an integer. The expoennt is followed by an optional suffix, which can be
either <code>f</code>, <code>F</code>, <code>d</code>, <code>D</code>, or <code>pNxM</code> where <code>N</code> and <code>M</code> are positive integers.
<code>p</code> and <code>x</code> can be either upper or lowercase.</p>
<p>The value of a floating-point literal is computed as follows: First the
mantissa is read as a rational number. Then it is multiplied by 10 to the
power of the exponent, which is interpreted as an integer, and defaults to
zero if it is not present. Finally, it is rounded to the nearest possible
value in a floating-point type represented like an IEEE754 floating-point type,
with the number of bits of precision and exponent specified by the suffix.
A suffix of <code>f</code> or <code>f</code> represents the IEEE <code>binary32</code> format. A suffix of <code>d</code>
or <code>D</code>, or no suffix, represents the IEEE <code>binary64</code> format. A suffix of
<code>pNxM</code> (either upper or lowercase) specifies exactly <code>N</code> bits of precision and
<code>M</code> bits of exponent. The number of bits of precision is assumed to include
any optional <code>1</code> that precedes the IEEE 754 mantissa. In other words, <code>p24x8</code>
is equal to the IEEE <code>binary32</code> format, and <code>p53x11</code> is equal to the IEEE
<code>binary64</code> format.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> FLOAT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">syntax</span> <span class="token keyword">Float</span> <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span><span class="token keyword">Float</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Float</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> r<span class="token string">"([\\+\\-]?[0-9]+(\\.[0-9]*)?|\\.[0-9]+)([eE][\\+\\-]?[0-9]+)?([fFdD]|([pP][0-9]+[xX][0-9]+))?"</span> <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">,</span> prec<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Float</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> r<span class="token string">"[\\+\\-]?Infinity([fFdD]|([pP][0-9]+[xX][0-9]+))?"</span> <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">,</span> prec<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Float</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> r<span class="token string">"NaN([fFdD]|([pP][0-9]+[xX][0-9]+))?"</span> <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">,</span> prec<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> FLOAT
  <span class="token keyword">imports</span> FLOAT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private BOOL
  <span class="token keyword">imports</span> private INT<span class="token operator">-</span>SYNTAX
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="float-precision">Float precision</h3>
<p>You can retrieve the number of bits of precision in a <code>Float</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> precisionFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>precision<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="float-exponent-bits">Float exponent bits</h3>
<p>You can retrieve the number of bits of exponent range in a <code>Float</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> exponentBitsFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>exponentBits<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="float-exponent">Float exponent</h3>
<p>You can retrieve the value of the exponent bits of a <code>Float</code> as an integer.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> exponentFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>exponent<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="float-sign">Float sign</h3>
<p>You can retrieve the value of the sign bit of a <code>Float</code> as a boolean. True
means the sign bit is set.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> signFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>sign<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="float-special-values">Float special values</h3>
<p>You can check whether a <code>Float</code> value is infinite or Not-a-Number.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> isNaN<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>          <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>isNaN<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>isNaN<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> isInfinite<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="float-arithmetic">Float arithmetic</h3>
<p>You can:</p>
<ul>
<li>Compute the unary negation <code>--Float</code> of a float. <code>--Float X</code> is distinct
from <code>0.0 -Float X</code>. For example, <code>0.0 -Float 0.0</code> is positive zero.
<code>--Float 0.0</code> is negative zero.</li>
<li>Compute the exponentation <code>^Float</code> of two floats.</li>
<li>Compute the product <code>*Float</code>, quotient <code>/Float</code>, or remainder <code>%Float</code> of two
floats. The remainder is computed based on rounding the quotient of the two
floats to the nearest integer.</li>
<li>Compute the sum <code>+Float</code> or difference <code>-Float</code> of two floats.</li>
</ul>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Float</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"--Float"</span> <span class="token keyword">Float</span>             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>neg<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>neg<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 &gt; <span class="token keyword">Float</span> <span class="token string">"^Float"</span> <span class="token keyword">Float</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>pow<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                   <span class="token keyword">Float</span> <span class="token string">"*Float"</span> <span class="token keyword">Float</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>fp<span class="token punctuation">.</span>mul roundNearestTiesToEven #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>mul<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> <span class="token keyword">Float</span> <span class="token string">"/Float"</span> <span class="token keyword">Float</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>fp<span class="token punctuation">.</span>div roundNearestTiesToEven #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>div<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> <span class="token keyword">Float</span> <span class="token string">"%Float"</span> <span class="token keyword">Float</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>fp<span class="token punctuation">.</span>rem roundNearestTiesToEven #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>rem<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                   <span class="token keyword">Float</span> <span class="token string">"+Float"</span> <span class="token keyword">Float</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>fp<span class="token punctuation">.</span>add roundNearestTiesToEven #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>add<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> <span class="token keyword">Float</span> <span class="token string">"-Float"</span> <span class="token keyword">Float</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>fp<span class="token punctuation">.</span>sub roundNearestTiesToEven #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>sub<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="floating-point-mathematics">Floating-point mathematics</h3>
<p>You can:</p>
<ul>
<li>Compute the Nth integer root <code>rootFloat</code> of a float.</li>
<li>Compute the absolute value <code>absFloat</code> of a float.</li>
<li>Round a floating-point number to a specified precision and exponent
range (<code>roundFloat</code>). The resulting <code>Float</code> will yield the specified values
when calling <code>precisionFloat</code> and <code>exponentBitsFloat</code> and when performing
further computation.</li>
<li>Round a float to the next lowest floating-point value which is an integer
(<code>floorFloat</code>).</li>
<li>Round a float to the next highest floating-point value which is an integer
(<code>ceilFloat</code>).</li>
<li>Round a float to the next closest floating-point value which is an integer, in
the direction of zero (<code>truncFloat</code>).</li>
<li>Compute the natural exponential <code>expFloat</code> of a float (i.e. e^x).</li>
<li>Compute the natural logarithm <code>logFloat</code> of a float.</li>
<li>Compute the sine <code>sinFloat</code> of a float.</li>
<li>Compute the cosine <code>cosFloat</code> of a float.</li>
<li>Compute the tangent <code>tanFlooat</code> of a float.</li>
<li>Compute the arcsine <code>asinFloat</code> of a float.</li>
<li>Compute the arccosine <code>acosFloat</code> of a float.</li>
<li>Compute the arctangent <code>atanFloat</code> of a float.</li>
<li>Compute the arctangent <code>atan2Float</code> of two floats.</li>
<li>Compute the maximum <code>maxFloat</code> of two floats.</li>
<li>Compute the minimum <code>minFloat</code> of two floats.</li>
<li>Compute the square root <code>sqrtFloat</code> of a float.</li>
<li>Compute the largest finite value expressible in a specified precision and
exponent range (<code>maxValueFloat</code>).</li>
<li>Compute the smallest positive finite value expressible in a specified
precision and exponent range (<code>minValueFloat</code>).</li>
</ul>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Float</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> rootFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>root<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> absFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>              <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>abs<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>abs<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> roundFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">,</span> precision<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> exponentBits<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>  <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>round<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> floorFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>            <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>floor<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> ceilFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>ceil<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> truncFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>            <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>trunc<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> expFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>              <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>exp<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> logFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>              <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> sinFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>              <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>sin<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> cosFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>              <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>cos<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> tanFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>              <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>tan<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> asinFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>asin<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> acosFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>acos<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> atanFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>atan<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> atan2Float<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">,</span> <span class="token keyword">Float</span><span class="token punctuation">)</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>atan2<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> maxFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">,</span> <span class="token keyword">Float</span><span class="token punctuation">)</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>max<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> minFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">,</span> <span class="token keyword">Float</span><span class="token punctuation">)</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>min<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>min<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> sqrtFloat<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>             <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
                 <span class="token operator">|</span> maxValueFloat<span class="token punctuation">(</span>precision<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> exponentBits<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>maxValue<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> minValueFloat<span class="token punctuation">(</span>precision<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> exponentBits<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>minValue<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="floating-point-comparisons">Floating-point comparisons</h3>
<p>Compute whether a float is less than or equasl to, less than, greater than or
equal to, greater than, equal, or unequal to another float. Note that
<code>X ==Float Y</code> and <code>X ==K Y</code> might yield different values. The latter should be
used in cases where you want to compare whether two values of sort <code>Float</code>
contain the same term. The former should be used when you want to implement
the <code>==</code> operator of a programming language. In particular, <code>NaN =/=Float NaN</code>
is true, because <code>NaN</code> compares unequal to all values, including itself, in
IEEE 754 arithmetic. <code>0.0 ==Float -0.0</code> is also true.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">Float</span> <span class="token string">"&lt;=Float"</span> <span class="token keyword">Float</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>leq<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>le<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Float</span> <span class="token string">"&lt;Float"</span> <span class="token keyword">Float</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>lt<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>lt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Float</span> <span class="token string">"&gt;=Float"</span> <span class="token keyword">Float</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>geq<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>ge<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Float</span> <span class="token string">"&gt;Float"</span> <span class="token keyword">Float</span>        <span class="token punctuation">[</span>function<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fg<span class="token punctuation">.</span>gt<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>gt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Float</span> <span class="token string">"==Float"</span> <span class="token keyword">Float</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>eq<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>eq<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">==</span>Float_<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">Float</span> <span class="token string">"=/=Float"</span> <span class="token keyword">Float</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>not <span class="token punctuation">(</span>fp<span class="token punctuation">.</span>eq #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token keyword">rule</span> F1<span class="token punctuation">:</span><span class="token keyword">Float</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Float</span> F2<span class="token punctuation">:</span><span class="token keyword">Float</span> <span class="token operator">=&gt;</span> notBool <span class="token punctuation">(</span>F1 <span class="token operator">==</span><span class="token keyword">Float</span> F2<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="conversion-between-integer-and-float">Conversion between integer and float</h3>
<p>You can convert an integer to a floating-point number with the specified
precision and exponent range. You can also convert a floating-point number
to the nearest integer. This operation rounds to the nearest integer, but it
also avoids the double-rounding that is present in <code>ceilFloat</code> and <code>floorFloat</code>
if the nearest integer is not representable in the specified floating-point
type.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Float</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Int2Float<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">,</span> precision<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> exponentBits<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>int2float<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Float2Int<span class="token punctuation">(</span><span class="token keyword">Float</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>FLOAT<span class="token punctuation">.</span>float2int<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="implementation-of-floats">Implementation of Floats</h3>
<p>The remainder of this section consists of an implementation in K of some of the
operators above.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">rule</span> sqrtFloat<span class="token punctuation">(</span>F<span class="token punctuation">:</span><span class="token keyword">Float</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> rootFloat<span class="token punctuation">(</span>F<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

  <span class="token keyword">rule</span> isInfinite<span class="token punctuation">(</span>F<span class="token punctuation">:</span><span class="token keyword">Float</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> F &gt;<span class="token keyword">Float</span> maxValueFloat<span class="token punctuation">(</span>precisionFloat<span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">,</span> exponentBitsFloat<span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">)</span> orBool F &lt;<span class="token keyword">Float</span> <span class="token operator">--</span><span class="token keyword">Float</span> maxValueFloat<span class="token punctuation">(</span>precisionFloat<span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">,</span> exponentBitsFloat<span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="strings">Strings</h2>
<p>Provided here is the syntax of an implementation of Unicode strings in K. This
type is hooked to an implementation of strings provided by the backend. The
implementation is currently incomplete and does not fully support encodings
and code points beyond the initial 256 code points of the Basic Latin and
Latin-1 Supplement blocks. In the future, there may be breaking changes to
the semantics of this module in order to support this functionality.</p>
<p>The syntax of strings in K is delineated by double quotes. Inside the double
quotes, any character can appear verbatim except double quotes, backslash,
newline, and carriage return. K also supports the following escape sequences:</p>
<ul>
<li>" - the " character</li>
<li>\ - the \ character</li>
<li>\n - newline character</li>
<li>\r - carriage return character</li>
<li>\t - tab character</li>
<li>\f - form feed character</li>
<li>\xFF - \x followed by two hexadecimal characters indicates a code point
between 0x00 and 0xff</li>
<li>\uFFFF - \u followed by four hexadecimal characters indicates a code point
between 0x0000 and 0xffff</li>
<li>\UFFFFFFFF - \U followed by eight hexadecimal characters indicates a code
point between 0x000000 and 0x10ffff</li>
</ul>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> STRING<span class="token operator">-</span>SYNTAX
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span><span class="token keyword">String</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> r<span class="token string">"[\\\"](([^\\\"\\n\\r\\\\])|([\\\\][nrtf\\\"\\\\])|([\\\\][x][0-9a-fA-F]{2})|([\\\\][u][0-9a-fA-F]{4})|([\\\\][U][0-9a-fA-F]{8}))*[\\\"]"</span>      <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> STRING<span class="token operator">-</span>COMMON
  <span class="token keyword">imports</span> STRING<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private INT
  <span class="token keyword">imports</span> private FLOAT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private K<span class="token operator">-</span>EQUAL
  <span class="token keyword">imports</span> private BOOL
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="string-concatenation">String concatenation</h3>
<p>You can concatenate two strings in O(N) time. For successive concatenation
operations, it may be better to use the <code>STRING-BUFFER</code> module.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">String</span> <span class="token string">"+String"</span> <span class="token keyword">String</span>    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">left</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>concat<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="string-length">String length</h3>
<p>You can get the length of a string in O(1) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> lengthString <span class="token punctuation">(</span> <span class="token keyword">String</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="character-and-integer-conversion">Character and integer conversion</h3>
<p>You can convert between a character (as represented by a string containing
a single code point) and an integer in O(1) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> chrChar <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>chr<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> ordChar <span class="token punctuation">(</span> <span class="token keyword">String</span> <span class="token punctuation">)</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>ord<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="string-substring">String substring</h3>
<p>You can compute a substring of a string in O(N) time (where N is the
length of the substring). There are two important facts to note:</p>
<ol>
<li>the range generated includes the character at <code>startIndex</code> but excludes the
character at <code>endIndex</code>, i.e., the range is <code>[startIndex..endIndex)</code>.</li>
<li>this function is only defined on valid indices (i.e., it is defined when
<code>startIndex &lt; endIndex</code> and <code>endIndex</code> is less than or equal to the string
length).</li>
</ol>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> substrString <span class="token punctuation">(</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> startIndex<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> endIndex<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>substr<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="string-search">String search</h3>
<p>You can find the first (respectively, last) occurrence of a substring, starting
at a certain <code>index</code>, in another string in O(N*M) time.
Returns <code>-1</code> if the substring is not found.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> findString <span class="token punctuation">(</span> haystack<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> needle<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>find<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> rfindString <span class="token punctuation">(</span> haystack<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> needle<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>  <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>rfind<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="string-character-search">String character search</h3>
<p>You can find the first (respectively, last) occurrence of one of the characters
of the search string, starting at a certain <code>index</code>, in another string in
O(N*M) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> findChar <span class="token punctuation">(</span> haystack<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> needles<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>findChar<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> rfindChar <span class="token punctuation">(</span> haystack<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> needles<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>rfindChar<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="string-and-bool-conversion">String and Bool conversion</h3>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Bool2String<span class="token punctuation">(</span><span class="token keyword">Bool</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> Bool2String<span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token string">"true"</span>
  <span class="token keyword">rule</span> Bool2String<span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">"false"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> String2Bool<span class="token punctuation">(</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> String2Bool<span class="token punctuation">(</span><span class="token string">"true"</span><span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
  <span class="token keyword">rule</span> String2Bool<span class="token punctuation">(</span><span class="token string">"false"</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="string-and-float-conversion">String and float conversion</h3>
<p>You can convert between a <code>String</code> and a <code>Float</code>. The String will be
represented in the syntax of the <code>Float</code> sort (see the section on the <code>FLOAT</code>
module above for details of that syntax). Which particular string is returned
by <code>Float2String</code> is determined by the backend, but the same <code>Float</code> is
guaranteed to return the same <code>String</code>, and converting that <code>String</code> back to a
<code>Float</code> is guaranteed to return the original <code>Float</code>.</p>
<p>You can also convert a <code>Float</code> to a string in a particular syntax using the
variant of <code>Float2String</code> with a <code>format</code>. In this case, the resulting string
is one which results directly from passing that <code>format</code> to <code>mpfr_printf</code>. This
functionality may not be supported on backends that do not use Gnu MPFR to
implement floating-point numbers.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Float2String <span class="token punctuation">(</span> <span class="token keyword">Float</span> <span class="token punctuation">)</span>              <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>float2string<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Float2String <span class="token punctuation">(</span> <span class="token keyword">Float</span> <span class="token punctuation">,</span> <span class="token class-name">format</span><span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">)</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>FloatFormat<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>floatFormat<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Float</span>  <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> String2Float <span class="token punctuation">(</span> <span class="token keyword">String</span> <span class="token punctuation">)</span>             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>string2float<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="string-and-integer-conversions">String and integer conversions</h3>
<p>You can convert between a <code>String</code> and an <code>Int</code>. The String will be represented
in the syntax of the <code>INT</code> module (i.e., a nonempty sequence of digits
optionally prefixed by a sign). When converting from an <code>Int</code> to a <code>String</code>,
the sign will not be present unless the integer is negative.</p>
<p>You can also convert between a <code>String</code> and an <code>Int</code> in a particular radix.
This radix can be anywhere between 2 and 36. For a radix 2 &lt;= N &lt;= 10, the
digits 0 to N-1 will be used. For a radix 11 &lt;= N &lt;= 36, the digits 0 to 9
and the first N-10 letters of the Latin alphabet will be used. Both uppercase
and lowercase letters are supported by <code>String2Base</code>. Whether the letters
returned by <code>Base2String</code> are upper or lowercase is determined by the backend,
but the backend will consistently choose one or the other.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span>    <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> String2Int   <span class="token punctuation">(</span> <span class="token keyword">String</span> <span class="token punctuation">)</span>             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>string2int<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Int2String   <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>                <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>int2string<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Base2String  <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> base<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>          <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>base2string<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Int</span>    <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> String2Base  <span class="token punctuation">(</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> base<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>string2base<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="string-count-and-replace">String count and replace</h3>
<p>You can replace one, some, or all occurrences of a string within another
string in O(N*M) time. The <code>replaceAll</code>, <code>replace</code>, and <code>replaceFirst</code> methods
are identical, except <code>replaceFirst</code> replaces exactly one ocurrence of the
string, the first occurrence. <code>replace</code> replaces the first <code>times</code> occurrences.
And <code>replaceAll</code> replaces every occurrence.</p>
<p>You can also count the number of times a string occurs within another string
using <code>countAllOccurrences</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"replaceAll"</span> <span class="token string">"("</span> haystack<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> needle<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> replacement<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">")"</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>replaceAll<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"replace"</span> <span class="token string">"("</span> haystack<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> needle<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> replacement<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> times<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>replace<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"replaceFirst"</span> <span class="token string">"("</span> haystack<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> needle<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> replacement<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">")"</span>    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>replaceFirst<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"countAllOccurrences"</span> <span class="token string">"("</span> haystack<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> needle<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">")"</span>            <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>countAllOccurrences<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="string-equality-and-lexicographic-comparison">String equality and lexicographic comparison</h3>
<p>You can compare whether two strings are equal or unequal, or whether one string
is less than, less than or equal to, greater than, or greater than or equal to
another according to the natural lexicographic ordering of strings.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">String</span> <span class="token string">"==String"</span> <span class="token keyword">String</span>  <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> comm<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>eq<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">String</span> <span class="token string">"=/=String"</span> <span class="token keyword">String</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> comm<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>ne<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">rule</span> S1<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">String</span> S2<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> notBool <span class="token punctuation">(</span>S1 <span class="token operator">==</span><span class="token keyword">String</span> S2<span class="token punctuation">)</span>

  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">String</span>  <span class="token string">"&lt;String"</span> <span class="token keyword">String</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>lt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">String</span> <span class="token string">"&lt;=String"</span> <span class="token keyword">String</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>le<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">String</span>  <span class="token string">"&gt;String"</span> <span class="token keyword">String</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>gt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token keyword">String</span> <span class="token string">"&gt;=String"</span> <span class="token keyword">String</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>ge<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="implementation-of-strings">Implementation of Strings</h3>
<p>What follows is a few String hooks which are deprecated and only are supported
on certain outdated backends of K, as well as an implementation of several
of the above operations in K.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> categoryChar<span class="token punctuation">(</span><span class="token keyword">String</span><span class="token punctuation">)</span>       <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>category<span class="token punctuation">)</span><span class="token punctuation">]</span>
                  <span class="token operator">|</span> directionalityChar<span class="token punctuation">(</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>directionality<span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"newUUID"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>uuid<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> S1<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">&lt;=</span><span class="token keyword">String</span> S2<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> notBool <span class="token punctuation">(</span>S2 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>String</span> <span class="token attr-name">S1)</span>
  <span class="token attr-name">rule</span> <span class="token attr-name"><span class="token namespace">S1:</span>String</span> <span class="token punctuation">&gt;</span></span><span class="token keyword">String</span> S2<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> S2 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>String</span> <span class="token attr-name">S1</span>
  <span class="token attr-name">rule</span> <span class="token attr-name"><span class="token namespace">S1:</span>String</span> <span class="token punctuation">&gt;</span></span><span class="token operator">=</span><span class="token keyword">String</span> S2<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> notBool <span class="token punctuation">(</span>S1 &lt;<span class="token keyword">String</span> S2<span class="token punctuation">)</span>

  <span class="token keyword">rule</span> findChar<span class="token punctuation">(</span>S1<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> S2<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> I<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #if findString<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> substrString<span class="token punctuation">(</span>S2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token operator">-</span><span class="token number">1</span> #then findChar<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> substrString<span class="token punctuation">(</span>S2<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> lengthString<span class="token punctuation">(</span>S2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">)</span> #else #if findChar<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> substrString<span class="token punctuation">(</span>S2<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> lengthString<span class="token punctuation">(</span>S2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token operator">-</span><span class="token number">1</span> #then findString<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> substrString<span class="token punctuation">(</span>S2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">)</span> #else minInt<span class="token punctuation">(</span>findString<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> substrString<span class="token punctuation">(</span>S2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">)</span><span class="token punctuation">,</span> findChar<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> substrString<span class="token punctuation">(</span>S2<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> lengthString<span class="token punctuation">(</span>S2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">)</span><span class="token punctuation">)</span> #fi #fi <span class="token keyword">requires</span> S2 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">String</span> <span class="token string">""</span>
  <span class="token keyword">rule</span> findChar<span class="token punctuation">(</span>_<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token keyword">rule</span> rfindChar<span class="token punctuation">(</span>S1<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> S2<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> I<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> maxInt<span class="token punctuation">(</span>rfindString<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> substrString<span class="token punctuation">(</span>S2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">)</span><span class="token punctuation">,</span> rfindChar<span class="token punctuation">(</span>S1<span class="token punctuation">,</span> substrString<span class="token punctuation">(</span>S2<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> lengthString<span class="token punctuation">(</span>S2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> I<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">requires</span> S2 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">String</span> <span class="token string">""</span>
  <span class="token keyword">rule</span> rfindChar<span class="token punctuation">(</span>_<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">-</span><span class="token number">1</span>

  <span class="token keyword">rule</span> countAllOccurrences<span class="token punctuation">(</span>Source<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> ToCount<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
            <span class="token keyword">requires</span> findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToCount<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> &lt;<span class="token keyword">Int</span> <span class="token number">0</span>
  <span class="token keyword">rule</span> countAllOccurrences<span class="token punctuation">(</span>Source<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> ToCount<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">1</span> <span class="token operator">+</span><span class="token keyword">Int</span> countAllOccurrences<span class="token punctuation">(</span>substrString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToCount<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> lengthString<span class="token punctuation">(</span>ToCount<span class="token punctuation">)</span><span class="token punctuation">,</span> lengthString<span class="token punctuation">(</span>Source<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ToCount<span class="token punctuation">)</span>
            <span class="token keyword">requires</span> findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToCount<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">0</span>

  <span class="token keyword">rule</span> replaceFirst<span class="token punctuation">(</span>Source<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> ToReplace<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> Replacement<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> substrString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToReplace<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">+</span><span class="token keyword">String</span> Replacement <span class="token operator">+</span><span class="token keyword">String</span> substrString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToReplace<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> lengthString<span class="token punctuation">(</span>ToReplace<span class="token punctuation">)</span><span class="token punctuation">,</span> lengthString<span class="token punctuation">(</span>Source<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">requires</span> findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToReplace<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">0</span>
  <span class="token keyword">rule</span> replaceFirst<span class="token punctuation">(</span>Source<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> ToReplace<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Source
        <span class="token keyword">requires</span> findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToReplace<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> &lt;<span class="token keyword">Int</span> <span class="token number">0</span>


  <span class="token comment">// Note that the replace function is undefined when Count &lt; 0. This allows different backends to</span>
  <span class="token comment">// implement their own behavior without contradicting these semantics. For instance, a symbolic</span>
  <span class="token comment">// backend can return #Bottom for that case, while a concrete backend can throw an exception.</span>
  <span class="token keyword">rule</span> replace<span class="token punctuation">(</span>Source<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> ToReplace<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> Replacement<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> Count<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
       substrString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToReplace<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">String</span> Replacement <span class="token operator">+</span><span class="token keyword">String</span>
       replace<span class="token punctuation">(</span>substrString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToReplace<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> lengthString<span class="token punctuation">(</span>ToReplace<span class="token punctuation">)</span><span class="token punctuation">,</span> lengthString<span class="token punctuation">(</span>Source<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ToReplace<span class="token punctuation">,</span> Replacement<span class="token punctuation">,</span> Count <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">requires</span> Count &gt;<span class="token keyword">Int</span> <span class="token number">0</span> andBool findString<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToReplace<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">0</span>
  <span class="token keyword">rule</span> replace<span class="token punctuation">(</span>Source<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> Count<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Source
        <span class="token keyword">requires</span> Count <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">0</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> replaceAll<span class="token punctuation">(</span>Source<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> ToReplace<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> Replacement<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> replace<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToReplace<span class="token punctuation">,</span> Replacement<span class="token punctuation">,</span> countAllOccurrences<span class="token punctuation">(</span>Source<span class="token punctuation">,</span> ToReplace<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> STRING<span class="token operator">-</span>KORE <span class="token punctuation">[</span>symbolic<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> private K<span class="token operator">-</span>EQUAL
  <span class="token keyword">imports</span> STRING<span class="token operator">-</span>COMMON

  <span class="token keyword">rule</span> S1<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">==</span>K S2<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> S1 <span class="token operator">==</span><span class="token keyword">String</span> S2 <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> STRING
  <span class="token keyword">imports</span> STRING<span class="token operator">-</span>COMMON
  <span class="token keyword">imports</span> STRING<span class="token operator">-</span>KORE
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="string-buffers">String Buffers</h2>
<p>It is a well known fact that repeated string concatenations are quadratic
in performance whereas use of an efficient mutable representation of arrays
can yield linear performance. We thus provide such a sort, the <code>StringBuffer</code>
sort. Axiomatically, it is implemented below on symbolic backends using the
<code>String</code> module. However, on concrete backends it provides an efficient
implementation of string concatenation. There are three operations:</p>
<ul>
<li><code>.StringBuffer</code> creates a new <code>StringBuffer</code> with current content equal
to the empty string.</li>
<li><code>+String</code> takes a <code>StringBuffer</code> and a <code>String</code> and appends the <code>String</code> to
the end of the <code>StringBuffer</code></li>
<li><code>StringBuffer2String</code> converts a <code>StringBuffer</code> to a <code>String</code>. This operation
copies the string so that subsequent modifications to the <code>StringBuffer</code>
will not change the value of the <code>String</code> returned by this function.</li>
</ul>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> STRING<span class="token operator">-</span>BUFFER<span class="token operator">-</span>IN<span class="token operator">-</span>K <span class="token punctuation">[</span>symbolic<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> private BASIC<span class="token operator">-</span>K
  <span class="token keyword">imports</span> STRING

  <span class="token keyword">syntax</span> StringBuffer <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">".StringBuffer"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> StringBuffer <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> StringBuffer <span class="token string">"+String"</span> <span class="token keyword">String</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">avoid</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> StringBuffer <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">String</span>
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> StringBuffer2String <span class="token punctuation">(</span> StringBuffer <span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token punctuation">{</span>SB<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">+</span><span class="token keyword">String</span> S<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">}</span><span class="token punctuation">:</span><span class="token punctuation">:</span>StringBuffer <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>SB <span class="token operator">+</span><span class="token keyword">String</span> S<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">String</span>
  <span class="token keyword">rule</span> <span class="token punctuation">.</span>StringBuffer <span class="token operator">=&gt;</span> <span class="token string">""</span>
  <span class="token keyword">rule</span> StringBuffer2String<span class="token punctuation">(</span>S<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> S
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> STRING<span class="token operator">-</span>BUFFER<span class="token operator">-</span>HOOKED <span class="token punctuation">[</span>concrete<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> private BASIC<span class="token operator">-</span>K
  <span class="token keyword">imports</span> STRING

  <span class="token keyword">syntax</span> StringBuffer <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>BUFFER<span class="token punctuation">.</span>StringBuffer<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> StringBuffer <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">".StringBuffer"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BUFFER<span class="token punctuation">.</span>empty<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> StringBuffer <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> StringBuffer <span class="token string">"+String"</span> <span class="token keyword">String</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BUFFER<span class="token punctuation">.</span>concat<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">avoid</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> StringBuffer2String <span class="token punctuation">(</span> StringBuffer <span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BUFFER<span class="token punctuation">.</span>toString<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> STRING<span class="token operator">-</span>BUFFER
  <span class="token keyword">imports</span> STRING<span class="token operator">-</span>BUFFER<span class="token operator">-</span>HOOKED
  <span class="token keyword">imports</span> STRING<span class="token operator">-</span>BUFFER<span class="token operator">-</span>IN<span class="token operator">-</span>K
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="byte-arrays">Byte Arrays</h2>
<p>Provided here is the syntax of an implementation of fixed-width arrays of Bytes
in K. This type is hooked to an implementation of bytes provided by the backend.
On the LLVM backend, it is possible to opt in to a faster, mutable
representation (using the <code>--llvm-mutable-bytes</code> flag to <code>kompile</code>) where
multiple references can occur to the same <code>Bytes</code> object and when one is
modified, the others are also modified. Care should be taken when using this
feature, however, as it is possible to experience divergent behavior with
symbolic backends unless the <code>Bytes</code> type is used in a manner that preserves
consistency.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> BYTES<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private STRING<span class="token operator">-</span>SYNTAX

  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> r<span class="token string">"b[\\\"](([ !#-\\[\\]-~])|([\\\\][tnfr\\\"\\\\])|([\\\\][x][0-9a-fA-F]{2}))*[\\\"]"</span>      <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> BYTES<span class="token operator">-</span>STRING<span class="token operator">-</span>ENCODE <span class="token punctuation">[</span>symbolic<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> BYTES<span class="token operator">-</span>SYNTAX
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="encoding%2Fdecoding-between-bytes-and-string">Encoding/decoding between Bytes and String</h3>
<p>You can encode/decode between Bytes and String using <code>UTF-8</code>, <code>UTF-16LE</code>, <code>UTF-16BE</code>, <code>UTF-32LE</code>, and <code>UTF-32BE</code></p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> decodeBytes <span class="token punctuation">(</span> encoding<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> contents<span class="token punctuation">:</span> Bytes <span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>decodeBytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> encodeBytes <span class="token punctuation">(</span> encoding<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">,</span> contents<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>encodeBytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> BYTES<span class="token operator">-</span>HOOKED
  <span class="token keyword">imports</span> STRING<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> BYTES<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> MINT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> BYTES<span class="token operator">-</span>STRING<span class="token operator">-</span>ENCODE
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="empty-byte-array">Empty byte array</h3>
<p>The byte array of length zero is represented by <code>.Bytes</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">".Bytes"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>empty<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="endianness">Endianness</h3>
<p>When converting to/from an integer, byte arrays can be treated as either little
endian (ie, least significant byte first) or big endian (ie, most significant
byte first).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Endianness <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"LE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>littleEndianBytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
                      <span class="token operator">|</span> <span class="token string">"BE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>bigEndianBytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="signedness">Signedness</h3>
<p>When converting to/from an integer, byte arrays can be treated as either signed
or unsigned.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Signedness <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"Signed"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>signedBytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
                      <span class="token operator">|</span> <span class="token string">"Unsigned"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>unsignedBytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="integer-and-bytes-conversion">Integer and Bytes conversion</h3>
<p>You can convert from a <code>Bytes</code> to an <code>Int</code>. In order to do this, the endianness
and signedness of the <code>Bytes</code> must be provided. The resulting integer is
created by means of interpreting the <code>Bytes</code> as either a twos-complement
representation, or an unsigned representation, of an integer, in the specified
byte order.</p>
<p>You can also convert from an <code>Int</code> to a <code>Bytes</code>. This comes in two variants.
In the first, the <code>length</code> of the resulting <code>Bytes</code> in bytes is explicitly
specified. If the <code>length</code> is greater than the highest set bit in the magnitude
of the integer, the result is padded with 0 bits if the number is positive
and 1 bits if the number is negative. If the <code>length</code> is less than the highest
bit set in the magnitude of the integer, the most-significant bits of the
integer will be truncated. The endianness of the resulting <code>Bytes</code> object
is as specified.</p>
<p>In the second variant, both endianness and signedness are specified, and
the resulting <code>Bytes</code> object will be the smallest number of bytes necessary
for the resulting <code>Bytes</code> object to be convertible back to the original integer
via <code>Bytes2Int</code>. In other words, if the highest bit set in the magnitude of the
integer is N, then the byte array will be at least N+1 bits long, rounded up
to the nearest byte.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Bytes2Int<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> Endianness<span class="token punctuation">,</span> Signedness<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>bytes2int<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Int2Bytes<span class="token punctuation">(</span>length<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> Endianness<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>int2bytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> Int2Bytes<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">,</span> Endianness<span class="token punctuation">,</span> Signedness<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>Int2BytesNoLen<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="string-and-bytes-conversion">String and Bytes conversion</h3>
<p>You can convert between a <code>Bytes</code> and a <code>String</code> in O(N) time. The resulting
value is a copy of the original and will not be affected by subsequent
mutations of the input or output value. <code>Bytes2Hex</code> uses hexadecimal encoding.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Bytes2String<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>bytes2string<span class="token punctuation">)</span><span class="token punctuation">]</span>
                  <span class="token operator">|</span> Bytes2Hex<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>bytes2hex<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> String2Bytes<span class="token punctuation">(</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>string2bytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="bytes-update">Bytes update</h3>
<p>You can set the value of a particular byte in a <code>Bytes</code> object in O(1) time,
either with index and value as <code>Int</code> or as an <code>MInt</code>. Currently, only 64-bit
and 256-bit <code>MInt</code> types are supported. The result is <code>#False</code> if <code>value</code> is
not in the range [0..255] or if <code>index</code> is not a valid index (ie, less than
zero or greater than or equal to the length of the <code>Bytes</code> term).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Bytes <span class="token string">"["</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">"&lt;-"</span> value<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>update<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Bytes <span class="token string">"["</span> index<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&lt;-"</span> value<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>updateMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="bytes-lookup">Bytes lookup</h3>
<p>You can get the value of a particular byte in a <code>Bytes</code> object in O(1) time, either as an <code>Int</code> or as an <code>MInt</code>. Currently, only 64-bit and 256-bit <code>MInt</code> types are supported.
The result is <code>#False</code> if <code>index</code> is not a valid index (see above).</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Bytes <span class="token string">"["</span> <span class="token keyword">Int</span> <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>get<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Bytes <span class="token string">"["</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"]"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>getMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="bytes-substring">Bytes substring</h3>
<p>You can get a new <code>Bytes</code> object containing a range of bytes from the input
<code>Bytes</code> in O(N) time (where N is the length of the substring). The range
of bytes included is <code>[startIndex..endIndex)</code>. The resulting <code>Bytes</code> is
a copy and mutations to it do not affect mutations to the original <code>Bytes</code>.
Both <code>startIndex</code> and <code>endIndex</code> can be either <code>Int</code> or <code>MInt</code> values, but,
currently, only 64-bit and 256-bit <code>MInt</code> types are supported.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> substrBytes<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> startIndex<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> endIndex<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>substr<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> substrBytes<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> startIndex<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">,</span> endIndex<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>substrMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>The function is not total: <code>substrBytes(B, startIndex, endIndex)</code> is <code>#Bottom</code> if</p>
<ul>
<li><code>startIndex &lt;Int 0</code> or</li>
<li><code>endIndex &lt;Int startIndex</code> or</li>
<li><code>lengthBytes(B) &lt;Int endIndex</code>.</li>
</ul>
<h3 id="multiple-bytes-update">Multiple bytes update</h3>
<p>You can modify a <code>Bytes</code> to return a <code>Bytes</code> which is equal to <code>dest</code> except the
<code>N</code> elements starting at <code>index</code> are replaced with the contents of <code>src</code> in O(N)
time. If <code>--llvm-mutable-bytes</code> is active, this will not create a new <code>Bytes</code>
object and will instead modify the original on concrete backends. The result is
<code>#False</code> if <code>index</code> + <code>N</code> is not a valid index. This function accepts both
<code>Int</code> and <code>MInt</code> values for <code>index</code> and <code>N</code>. Currently, only 64-bit and
256-bit <code>MInt</code> types are supported.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> replaceAtBytes<span class="token punctuation">(</span>dest<span class="token punctuation">:</span> Bytes<span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> src<span class="token punctuation">:</span> Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>replaceAt<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> replaceAtBytes<span class="token punctuation">(</span>dest<span class="token punctuation">:</span> Bytes<span class="token punctuation">,</span> index<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">,</span> src<span class="token punctuation">:</span> Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>replaceAtMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="multiple-bytes-update-1">Multiple bytes update</h3>
<p>You can modify a <code>Bytes</code> to return a <code>Bytes</code> which is equal to <code>dest</code> except the
<code>count</code> bytes starting at <code>index</code> are replaced with <code>count</code> bytes of value
<code>Int2Bytes(1, v, LE/BE)</code> in O(count) time. This does not create a new <code>Bytes</code>
object and will instead modify the original if <code>--llvm-mutable-bytes</code> is active.
This will throw an exception if <code>index</code> + <code>count</code> is not a valid index. The
acceptable range of values for <code>v</code> is -128 to 127. This will throw an exception
if <code>v</code> is outside of this range. This is implemented only for the LLVM backend.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> memsetBytes<span class="token punctuation">(</span>dest<span class="token punctuation">:</span> Bytes<span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> count<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> v<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>memset<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="bytes-padding">Bytes padding</h3>
<p>You can create a new <code>Bytes</code> object which is at least <code>length</code> bytes long by
taking the input sequence and padding it on the right (respectively, on the
left) with the specified <code>value</code>. If <code>--llvm-mutable-bytes</code> is active, this does
not create a new <code>Bytes</code> object if the input is already at least <code>length</code> bytes
long, and will instead return the input unchanged. The result is <code>#False</code> if
<code>value</code> is not in the range <code>[0..255]</code>, or if the length is negative.
We also provide a variant of this function which takes an <code>MInt</code> for the
<code>length</code> and <code>value</code>. The current implementation only supports 64-bit and
256-bit <code>MInt</code> types.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> padRightBytes<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>padRight<span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> padLeftBytes<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>padLeft<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> padRightBytes<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> length<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>padRightMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                         <span class="token operator">|</span> padLeftBytes<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> length<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>padLeftMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="bytes-reverse">Bytes reverse</h3>
<p>You can reverse a <code>Bytes</code> object in O(N) time. If <code>--llvm-mutable-bytes</code> is
active, this will not create a new <code>Bytes</code> object and will instead modify the
original.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> reverseBytes<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>reverse<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="bytes-length">Bytes length</h3>
<p>You can get the length of a <code>Bytes</code> term in O(1) time. The lenghth can be either
an <code>Int</code> or an <code>MInt</code>. Currently, only 64-bit and 256-bit <code>MInt</code> types are supported.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> lengthBytes<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>lengthBytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> lengthBytes<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>lengthMInt<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="bytes-concatenation">Bytes concatenation</h3>
<p>You can create a new <code>Bytes</code> object by concatenating two <code>Bytes</code> objects
together in O(N) time.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Bytes <span class="token string">"+Bytes"</span> Bytes <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>BYTES<span class="token punctuation">.</span>concat<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">right</span><span class="token punctuation">]</span>

<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="implementation-of-bytes">Implementation of Bytes</h3>
<p>The remainder of this module consists of an implementation of some of the
operators listed above in K.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> BYTES<span class="token operator">-</span>CONCRETE <span class="token punctuation">[</span>concrete<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> BYTES<span class="token operator">-</span>HOOKED
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> BYTES<span class="token operator">-</span>KORE
  <span class="token keyword">imports</span> BYTES<span class="token operator">-</span>HOOKED
  <span class="token keyword">imports</span> BYTES<span class="token operator">-</span>SYMBOLIC<span class="token operator">-</span>CEIL
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> BYTES<span class="token operator">-</span>SYMBOLIC<span class="token operator">-</span>CEIL <span class="token punctuation">[</span>symbolic<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> BYTES<span class="token operator">-</span>HOOKED
  <span class="token keyword">imports</span> private INT
  <span class="token keyword">imports</span> private BOOL

  <span class="token keyword">rule</span> #Ceil<span class="token punctuation">(</span>padRightBytes<span class="token punctuation">(</span>_<span class="token punctuation">,</span> LEN<span class="token punctuation">,</span> VAL<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> LEN andBool <span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> VAL andBool VAL &lt;<span class="token keyword">Int</span> <span class="token number">256</span><span class="token punctuation">)</span> #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> #Ceil<span class="token punctuation">(</span>padLeftBytes<span class="token punctuation">(</span>_<span class="token punctuation">,</span> LEN<span class="token punctuation">,</span> VAL<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> LEN andBool <span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> VAL andBool VAL &lt;<span class="token keyword">Int</span> <span class="token number">256</span><span class="token punctuation">)</span> #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> BYTES
  <span class="token keyword">imports</span> BYTES<span class="token operator">-</span>CONCRETE
  <span class="token keyword">imports</span> BYTES<span class="token operator">-</span>KORE
  <span class="token keyword">imports</span> private INT

  <span class="token keyword">rule</span> Int2Bytes<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span><span class="token punctuation">:</span>Endianness<span class="token punctuation">,</span> _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes
    <span class="token keyword">requires</span> I <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
  <span class="token keyword">rule</span> Int2Bytes<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> E<span class="token punctuation">:</span><span class="token punctuation">:</span>Endianness<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Int2Bytes<span class="token punctuation">(</span><span class="token punctuation">(</span>log2Int<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">8</span><span class="token punctuation">,</span> I<span class="token punctuation">,</span> E<span class="token punctuation">)</span>
    <span class="token keyword">requires</span> I &gt;<span class="token keyword">Int</span> <span class="token number">0</span> <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> Int2Bytes<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> E<span class="token punctuation">:</span><span class="token punctuation">:</span>Endianness<span class="token punctuation">,</span> Signed  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Int2Bytes<span class="token punctuation">(</span><span class="token punctuation">(</span>log2Int<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">8</span><span class="token punctuation">,</span> I<span class="token punctuation">,</span> E<span class="token punctuation">)</span>
    <span class="token keyword">requires</span> I &gt;<span class="token keyword">Int</span> <span class="token number">0</span> <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> Int2Bytes<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> E<span class="token punctuation">:</span><span class="token punctuation">:</span>Endianness<span class="token punctuation">,</span> Signed  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Int2Bytes<span class="token punctuation">(</span><span class="token punctuation">(</span>log2Int<span class="token punctuation">(</span><span class="token operator">~</span><span class="token keyword">Int</span> I<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">8</span><span class="token punctuation">,</span> I<span class="token punctuation">,</span> E<span class="token punctuation">)</span>
    <span class="token keyword">requires</span> I &lt;<span class="token keyword">Int</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> Int2Bytes<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> E<span class="token punctuation">:</span><span class="token punctuation">:</span>Endianness<span class="token punctuation">,</span> Signed  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Int2Bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> E<span class="token punctuation">)</span>
    <span class="token keyword">requires</span> I <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="program-identifiers">Program identifiers</h2>
<p>Provided here is an implementation for program identifiers in K. Developers
of semantics for a particular language may wish to use their own implementation
instead of the one provided here if their syntax differs from the syntax
defined below. However, this is provided for convenience for developers who
do not care about the lexical syntax of identifiers.</p>
<p>Provided are the following pieces of functionality:</p>
<ul>
<li><code>Id2String</code> - Convert an <code>Id</code> to a <code>String</code> containing its name</li>
<li><code>String2Id</code> - Convert a <code>String</code> to an <code>Id</code> with the specified name</li>
<li>!X:Id - You can get a fresh identifier distinct from any previous identifier
generated by this syntax.</li>
</ul>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> ID<span class="token operator">-</span>SYNTAX<span class="token operator">-</span>PROGRAM<span class="token operator">-</span>PARSING
  <span class="token keyword">imports</span> BUILTIN<span class="token operator">-</span>ID<span class="token operator">-</span>TOKENS
  <span class="token keyword">syntax</span> <span class="token keyword">Id</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> r<span class="token string">"[A-Za-z\\_][A-Za-z0-9\\_]*"</span>     <span class="token punctuation">[</span>prec<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">token</span><span class="token punctuation">]</span>
              <span class="token operator">|</span> #LowerId                                             <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">]</span>
              <span class="token operator">|</span> #UpperId                                             <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> ID<span class="token operator">-</span>SYNTAX
  <span class="token keyword">syntax</span> <span class="token keyword">Id</span> <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> ID<span class="token operator">-</span>COMMON
  <span class="token keyword">imports</span> ID<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private STRING

  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Id2String <span class="token punctuation">(</span> <span class="token keyword">Id</span> <span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>token2string<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Id</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> String2Id <span class="token punctuation">(</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>STRING<span class="token punctuation">.</span>string2token<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">Id</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> freshId<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>freshGenerator<span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> private<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> freshId<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> String2Id<span class="token punctuation">(</span><span class="token string">"_"</span> <span class="token operator">+</span><span class="token keyword">String</span> Int2String<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> ID
  <span class="token keyword">imports</span> ID<span class="token operator">-</span>COMMON
<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="equality-and-conditionals">Equality and conditionals</h2>
<p>Provided here are implementations of two important primitives in K:</p>
<ul>
<li><code>==K</code> - the equality between two terms. Returns <code>true</code> if they are equal
and <code>false</code> if they are not equal.</li>
<li><code>#if #then #else #fi</code> - polymorphic conditional function. If the first
argument evaluates to <code>true</code>, the second argument is returned. Otherwise,
the third argument is returned. Note that this does not short-circuit on
symbolic backends.</li>
</ul>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> K<span class="token operator">-</span>EQUAL<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private BOOL
  <span class="token keyword">imports</span> private BASIC<span class="token operator">-</span>K

  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token class-name">left</span><span class="token punctuation">:</span>
                  K <span class="token string">"==K"</span> K           <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">=</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KEQUAL<span class="token punctuation">.</span>eq<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">==</span>K_<span class="token punctuation">)</span><span class="token punctuation">,</span> group<span class="token punctuation">(</span>equalEqualK<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token operator">|</span> K <span class="token string">"=/=K"</span> K          <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> comm<span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>distinct<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KEQUAL<span class="token punctuation">.</span>ne<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>_<span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K_<span class="token punctuation">)</span><span class="token punctuation">,</span> group<span class="token punctuation">(</span>notEqualEqualK<span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token keyword">syntax priority</span> equalEqualK notEqualEqualK &gt; boolOperation mlOp

  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Sort<span class="token punctuation">}</span> Sort <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#if"</span> <span class="token keyword">Bool</span> <span class="token string">"#then"</span> Sort <span class="token string">"#else"</span> Sort <span class="token string">"#fi"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>ite<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>ite<span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KEQUAL<span class="token punctuation">.</span>ite<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> K<span class="token operator">-</span>EQUAL<span class="token operator">-</span>KORE <span class="token punctuation">[</span>symbolic<span class="token punctuation">]</span>
  <span class="token keyword">imports</span> private BOOL
  <span class="token keyword">imports</span> K<span class="token operator">-</span>EQUAL<span class="token operator">-</span>SYNTAX

  <span class="token keyword">rule</span> K1<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">==</span>K K2<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> K1 <span class="token operator">==</span><span class="token keyword">Bool</span> K2 <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>K1 <span class="token operator">==</span>K K2 #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">true</span> #Equals K1 <span class="token operator">==</span>K K2<span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>K1 <span class="token operator">==</span>K K2 #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals K1 <span class="token operator">==</span>K K2<span class="token punctuation">}</span> <span class="token operator">=&gt;</span> #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2 #Equals <span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">true</span> #Equals K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2<span class="token punctuation">}</span> <span class="token operator">=&gt;</span> #Not<span class="token punctuation">(</span><span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span>K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2 #Equals <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">{</span><span class="token boolean">false</span> #Equals K1 <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2<span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>K1 #Equals K2<span class="token punctuation">}</span> <span class="token punctuation">[</span>simplification<span class="token punctuation">]</span>

<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> K<span class="token operator">-</span>EQUAL
  <span class="token keyword">imports</span> private BOOL
  <span class="token keyword">imports</span> K<span class="token operator">-</span>EQUAL<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> K<span class="token operator">-</span>EQUAL<span class="token operator">-</span>KORE

  <span class="token keyword">rule</span> K1<span class="token punctuation">:</span>K <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K K2<span class="token punctuation">:</span>K <span class="token operator">=&gt;</span> notBool <span class="token punctuation">(</span>K1 <span class="token operator">==</span>K K2<span class="token punctuation">)</span>

  <span class="token keyword">rule</span> #if C<span class="token punctuation">:</span><span class="token keyword">Bool</span> #then B1<span class="token punctuation">:</span><span class="token punctuation">:</span>K #else _ #fi <span class="token operator">=&gt;</span> B1 <span class="token keyword">requires</span> C
  <span class="token keyword">rule</span> #if C<span class="token punctuation">:</span><span class="token keyword">Bool</span> #then _ #else B2<span class="token punctuation">:</span><span class="token punctuation">:</span>K #fi <span class="token operator">=&gt;</span> B2 <span class="token keyword">requires</span> notBool C

<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="meta-operations">Meta operations</h2>
<p>Provided below are a few miscellaneous, mostly deprecated functions in K.
It is not recommended to use any of them directly as they are largely
unsupported in modern K. There are a few exceptions:</p>
<ul>
<li><code>#getenv</code> - Returns the value of an environment variable</li>
<li><code>#kompiledDirectory</code> - Returns the path to the current compiled K definition
directory.</li>
<li><code>#unparseKORE</code> - Takes a K term and converts it to a string.</li>
</ul>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> K<span class="token operator">-</span>REFLECTION
  <span class="token keyword">imports</span> BASIC<span class="token operator">-</span>K
  <span class="token keyword">imports</span> STRING

  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#configuration"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> impure<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KREFLECTION<span class="token punctuation">.</span><span class="token keyword">configuration</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #sort<span class="token punctuation">(</span>K<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KREFLECTION<span class="token punctuation">.</span>sort<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #fresh<span class="token punctuation">(</span><span class="token keyword">String</span><span class="token punctuation">)</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KREFLECTION<span class="token punctuation">.</span>fresh<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> getsymbol<span class="token punctuation">(</span>K<span class="token punctuation">)</span>  <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KREFLECTION<span class="token punctuation">.</span>getKLabel<span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #getenv<span class="token punctuation">(</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> impure<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KREFLECTION<span class="token punctuation">.</span>getenv<span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token keyword">syntax</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #kompiledDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KREFLECTION<span class="token punctuation">.</span>kompiledDir<span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token comment">// meaningful only for the purposes of compilation to a binary, otherwise</span>
  <span class="token comment">// undefined</span>
  <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #argv<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KREFLECTION<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Sort<span class="token punctuation">}</span> <span class="token keyword">String</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #unparseKORE<span class="token punctuation">(</span>Sort<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>KREFLECTION<span class="token punctuation">.</span>printKORE<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> IOError <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#noParse"</span> <span class="token string">"("</span> <span class="token keyword">String</span> <span class="token string">")"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#noParse<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="i%2Fo-in-k">I/O in K</h2>
<p>Concrete execution in K supports I/O operations. This functionality is not
supported during symbolic execution, because symbolic execution must exist
completely free of side-effects, and I/O is an irreducible type of side effect.
However, it is useful in many cases when defining concrete execution to be able
to make reference to I/O operations.</p>
<p>The design of these I/O operations is based on the POSIX standard, for the most
part. For example, the <code>#read</code> K function maps to the <code>read</code> POSIX function. We
do not at this time have a higher-level API for I/O, but this may be
implemented at some point in the future.</p>
<p>I/O operations generally return either their result, or an <code>IOError</code> term
corresponding to the <code>errno</code> returned by the underlying system call.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> K<span class="token operator">-</span>IO
  <span class="token keyword">imports</span> private LIST
  <span class="token keyword">imports</span> private STRING
  <span class="token keyword">imports</span> private INT
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="i%2Fo-errors">I/O errors</h3>
<p>Aside from EOF, which is returned by <code>#getc</code> if the file is at end-of-file, all
of the below I/O errors correspond to possible values for <code>errno</code> after calling
a library function. If the <code>errno</code> returned is not one of the below errnos
known to K, <code>#unknownIOError</code> is returned along with the integer errno value.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> IOError <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#EOF"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EOF<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> #unknownIOError<span class="token punctuation">(</span>errno<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#unknownIOError<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#E2BIG"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#E2BIG<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EACCES"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EACCES<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EAGAIN"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EAGAIN<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EBADF"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EBADF<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EBUSY"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EBUSY<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ECHILD"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ECHILD<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EDEADLK"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EDEADLK<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EDOM"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EDOM<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EEXIST"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EEXIST<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EFAULT"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EFAULT<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EFBIG"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EFBIG<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EINTR"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EINTR<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EINVAL"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EINVAL<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EIO"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EIO<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EISDIR"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EISDIR<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EMFILE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EMFILE<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EMLINK"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EMLINK<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENAMETOOLONG"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENAMETOOLONG<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENFILE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENFILE<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENODEV"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENODEV<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOENT"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOENT<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOEXEC"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOEXEC<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOLCK"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOLCK<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOMEM"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOMEM<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOSPC"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOSPC<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOSYS"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOSYS<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOTDIR"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOTDIR<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOTEMPTY"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOTEMPTY<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOTTY"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOTTY<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENXIO"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENXIO<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EPERM"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EPERM<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EPIPE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EPIPE<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ERANGE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ERANGE<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EROFS"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EROFS<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ESPIPE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ESPIPE<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ESRCH"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ESRCH<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EXDEV"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EXDEV<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EWOULDBLOCK"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EWOULDBLOCK<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EINPROGRESS"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EINPROGRESS<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EALREADY"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EALREADY<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOTSOCK"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOTSOCK<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EDESTADDRREQ"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EDESTADDRREQ<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EMSGSIZE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EMSGSIZE<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EPROTOTYPE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EPROTOTYPE<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOPROTOOPT"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOPROTOOPT<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EPROTONOSUPPORT"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EPROTONOSUPPORT<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ESOCKTNOSUPPORT"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ESOCKTNOSUPPORT<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EOPNOTSUPP"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EOPNOTSUPP<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EPFNOSUPPORT"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EPFNOSUPPORT<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EAFNOSUPPORT"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EAFNOSUPPORT<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EADDRINUSE"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EADDRINUSE<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EADDRNOTAVAIL"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EADDRNOTAVAIL<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENETDOWN"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENETDOWN<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENETUNREACH"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENETUNREACH<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENETRESET"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENETRESET<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ECONNABORTED"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ECONNABORTED<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ECONNRESET"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ECONNRESET<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOBUFS"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOBUFS<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EISCONN"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EISCONN<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ENOTCONN"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ENOTCONN<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ESHUTDOWN"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ESHUTDOWN<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ETOOMANYREFS"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ETOOMANYREFS<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ETIMEDOUT"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ETIMEDOUT<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ECONNREFUSED"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ECONNREFUSED<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EHOSTDOWN"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EHOSTDOWN<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EHOSTUNREACH"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EHOSTUNREACH<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#ELOOP"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ELOOP<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#EOVERFLOW"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#EOVERFLOW<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="i%2Fo-result-sorts">I/O result sorts</h3>
<p>Here we see sorts defined to contain either an <code>Int</code> or an <code>IOError</code>, or
either a <code>String</code> or an <code>IOError</code>. These sorts are used to implement the
return sort of functions that may succeed, in which case they return a value,
or may fail, in which case their return value indicates an error and the
error indicated is returned via <code>errno</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> IOInt <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">Int</span> <span class="token operator">|</span> IOError
  <span class="token keyword">syntax</span> IOString <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">String</span> <span class="token operator">|</span> IOError
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="opening-a-file">Opening a file</h3>
<p>You can open a file in K using <code>#open</code>. An optional mode indicates the file
open mode, which can have any value allowed by the <code>fopen</code> function in C.
The returned value is the file descriptor that was opened, or an error.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> IOInt <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#open"</span> <span class="token string">"("</span> path<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
               <span class="token operator">|</span> <span class="token string">"#open"</span> <span class="token string">"("</span> path<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> mode<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>open<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> #open<span class="token punctuation">(</span>S<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #open<span class="token punctuation">(</span>S<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token string">"r+"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="get%2Fset-position-in-file">Get/set position in file</h3>
<p>You can get the current offset in a file using <code>#tell</code>. You can also seek
to a particular offset using <code>#seek</code> or <code>#seekEnd</code>. <code>#seek</code> is implemented via
a call to <code>lseek</code> with the <code>SEEK_SET</code> whence. <code>#seekEnd</code> is implemented via a
call to <code>lseek</code> with the <code>SEEK_END</code> whence. You can emulate the <code>SEEK_CUR</code>
whence by means of <code>#seek(FD, #tell(FD) +Int Offset)</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> IOInt <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#tell"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>tell<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#seek"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">","</span> index<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>seek<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
             <span class="token operator">|</span> <span class="token string">"#seekEnd"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">","</span> fromEnd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>seekEnd<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="read-from-file">Read from file</h3>
<p>You can read a single character from a file using <code>#getc</code>. <code>#EOF</code> is returned
if you are at end-of-fie.</p>
<p>You can also read up to <code>length</code> characters in a file using <code>#read</code>. The
resulting read characters are returned, which may be fewer characters than
requested. A string of zero length being returned indicates end-of-file.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> IOInt <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#getc"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span>             <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>getc<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> IOString <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#read"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">","</span> length<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span>    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>read<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="write-to-file">Write to file</h3>
<p>You can write a single character to a file using <code>#putc</code>. You can also write
a string to a file using <code>#write</code>. The returned value on success is <code>.K</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#putc"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">","</span> value<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span>      <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>putc<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
             <span class="token operator">|</span> <span class="token string">"#write"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">","</span> value<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>write<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="closing-a-file">Closing a file</h3>
<p>You can close a file using <code>#close</code>. The returned value on success is <code>.K</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#close"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>close<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="locking%2Funlocking-a-file">Locking/unlocking a file</h3>
<p>You can lock or unlock parts of a file using the <code>#lock</code> and <code>#unlock</code>
functions. The lock starts at the beginning of the file and continues for
<code>endIndex</code> bytes. Note that Unix systems do not actually prevent locked files
from being read and modified; you will have to lock both sides of a concurrent
access to guarantee exclusivity.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#lock"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">","</span> endIndex<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>lock<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
             <span class="token operator">|</span> <span class="token string">"#unlock"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">","</span> endIndex<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>unlock<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="networking">Networking</h3>
<p>You can accept a connection on a socket using <code>#accept</code>, or shut down the
write end of a socket with <code>#shutdownWrite</code>. Note that facility is not provided
for opening, binding, and listening on sockets. These functions are implemented
in order to support creating stateful request/response servers where the
request loop is implemented using rewriting in K, but the connection
initialization is written in native code and linked into the LLVM backend.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> IOInt <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#accept"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>accept<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#shutdownWrite"</span> <span class="token string">"("</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>shutdownWrite<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="time">Time</h3>
<p>You can get the current time in seconds since midnight UTC on January 1, 1970
using <code>#time</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#time"</span> <span class="token string">"("</span> <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="builtin-file-descriptors">Builtin file descriptors</h3>
<p>Provided here are functions that return the file descriptor for standard input,
standard output, and standard error.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#stdin"</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token string">"#stdout"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                <span class="token operator">|</span> <span class="token string">"#stderr"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> #stdin <span class="token operator">=&gt;</span> <span class="token number">0</span>
  <span class="token keyword">rule</span> #stdout <span class="token operator">=&gt;</span> <span class="token number">1</span>
  <span class="token keyword">rule</span> #stderr <span class="token operator">=&gt;</span> <span class="token number">2</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="shell-access">Shell access</h3>
<p>You can execute a command using the shell using the <code>#system</code> operator. Care
must be taken to sanitize inputs to this function or security issues may
result. Note that K has no facility for reasoning about logic that happens
outside its process, so any functionality that you wish to be able to formally
reason about in K should not be implemented via the <code>#system</code> operator.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #system <span class="token punctuation">(</span> <span class="token keyword">String</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>system<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
                 <span class="token operator">|</span> <span class="token string">"#systemResult"</span> <span class="token string">"("</span> <span class="token keyword">Int</span> <span class="token comment">/* exit code */</span> <span class="token string">","</span> <span class="token keyword">String</span> <span class="token comment">/* stdout */</span> <span class="token string">","</span> <span class="token keyword">String</span> <span class="token comment">/* stderr */</span> <span class="token string">")"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#systemResult<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="temporary-files">Temporary files</h3>
<p>You can get a temporary file and open it atomically using the <code>#mkstemp</code>
operator. The resulting file will be closed and deleted when K rewriting ends.
For more info on the argument to <code>#mkstemp</code>, see <code>man mkstemp</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> IOFile <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #mkstemp<span class="token punctuation">(</span>template<span class="token punctuation">:</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>mkstemp<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> IOFile <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> IOError
                  <span class="token operator">|</span> <span class="token string">"#tempFile"</span> <span class="token string">"("</span> path<span class="token punctuation">:</span> <span class="token keyword">String</span> <span class="token string">","</span> fd<span class="token punctuation">:</span> <span class="token keyword">Int</span> <span class="token string">")"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#tempFile<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="deleting-a-file">Deleting a file</h3>
<p>You can delete a file using its absolute or relative path using the <code>#remove</code>
operator. It returns <code>.K</code> on success or an <code>IOError</code> on failure.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #remove<span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>remove<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="logging">Logging</h3>
<p>You can log information to disk using the <code>#logToFile</code> operator. Semantically,
this operator returns <code>.K</code>. However, it has a side effect that is not reasoned
about which is that <code>value</code> will be written to a uniquely-identified file
containing <code>name</code> in its name. The file is only flushed to disk when rewriting
finishes.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #logToFile<span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token keyword">String</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">,</span> returnsUnit<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>#logToFile<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Strings can also be logged via the logging mechanisms available to the backend.
On the LLVM backend, this just means logging the text to standard error. On the
Haskell backend, a log message of type InfoUserLog is created with the
specified text.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #log<span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>logString<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">,</span> returnsUnit<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>#log<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Terms can also be logged to standard error in <em>surface syntax</em>, rather than as
KORE using <code>#trace</code>. This operator has similar semantics to <code>#logToFile</code> (i.e.
it returns <code>.K</code>, but prints as an impure side effect). Note that calling
<code>#trace</code> is equivalent to invoking the <code>kprint</code> tool for the first term that is
logged, which requires re-parsing the underlying K definition. Subsequent calls
do not incur this overhead again; the definition is cached.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> K <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #trace<span class="token punctuation">(</span>value<span class="token punctuation">:</span> KItem<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>traceTerm<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">,</span> returnsUnit<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>#trace<span class="token punctuation">)</span><span class="token punctuation">]</span>
             <span class="token operator">|</span> #traceK<span class="token punctuation">(</span>value<span class="token punctuation">:</span> K<span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>IO<span class="token punctuation">.</span>traceTerm<span class="token punctuation">)</span><span class="token punctuation">,</span> impure<span class="token punctuation">,</span> returnsUnit<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>#traceK<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="implementation-of-high-level-i%2Fo-streams-in-k">Implementation of high-level I/O streams in K</h3>
<p>Below is an implementation of the <code>stream="stdin"</code> and <code>stream="stdout"</code>
cell attributes in K. You should not refer to these symbols or modules directly
in your definition. It is provided only so that the K compiler can make use of
it. For more information on how to use this feature, refer to IMP++ in the K
tutorial.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> Stream <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #buffer<span class="token punctuation">(</span>K<span class="token punctuation">)</span>
                  <span class="token operator">|</span> #istream<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span>
                  <span class="token operator">|</span> #parseInput<span class="token punctuation">(</span><span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">String</span><span class="token punctuation">)</span>
                  <span class="token operator">|</span> #ostream<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span>

<span class="token keyword">endmodule</span>

<span class="token comment">// NOTE: DO NOT DIRECTLY IMPORT *-STREAM MODULES</span>
<span class="token comment">// These stream modules will be automatically instantiated and implicitly imported</span>
<span class="token comment">// into the main module when `stream` attributes appear in configuration cells.</span>
<span class="token comment">// Only `Stream` productions and `[stream]` rules will be imported.</span>
<span class="token comment">// The cell name will be replaced with the one of the main configuration.</span>

<span class="token keyword">module</span> STDIN<span class="token operator">-</span>STREAM
  <span class="token keyword">imports</span> K<span class="token operator">-</span>IO
  <span class="token keyword">imports</span> K<span class="token operator">-</span>REFLECTION
  <span class="token keyword">imports</span> LIST
  <span class="token keyword">imports</span> INT
  <span class="token keyword">imports</span> BOOL

  <span class="token keyword">configuration</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdin</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>$STDIN<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>$IO<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>#istream<span class="token punctuation">(</span>#stdin<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdin</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">// read one character at a time until we read whitespace</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>stdinGetc<span class="token punctuation">]</span><span class="token punctuation">:</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdin</span><span class="token punctuation">&gt;</span></span>
       ListItem<span class="token punctuation">(</span>#parseInput<span class="token punctuation">(</span>_<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> Delimiters<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>S<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> S <span class="token operator">+</span><span class="token keyword">String</span> chrChar<span class="token punctuation">(</span><span class="token punctuation">{</span>#getc<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">:</span>&gt;<span class="token keyword">Int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span><span class="token string">"on"</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>#istream<span class="token punctuation">(</span>N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdin</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">requires</span> findChar<span class="token punctuation">(</span>S<span class="token punctuation">,</span> Delimiters<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token comment">// [stdin]</span>
       <span class="token punctuation">[</span>stream<span class="token punctuation">,</span> priority<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token comment">// when we reach whitespace, if it parses create a ListItem</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>stdinParseString<span class="token punctuation">]</span><span class="token punctuation">:</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdin</span><span class="token punctuation">&gt;</span></span>
       <span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>#parseInput<span class="token punctuation">(</span><span class="token string">"String"</span><span class="token punctuation">,</span> Delimiters<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ListItem<span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>S<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       _<span class="token punctuation">:</span>List
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdin</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">requires</span> findChar<span class="token punctuation">(</span>S<span class="token punctuation">,</span> Delimiters<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token comment">// [stdin]</span>
       <span class="token punctuation">[</span>stream<span class="token punctuation">]</span>

  <span class="token comment">// a hack: handle the case when we read integers without the help of the IO server</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>stdinParseInt<span class="token punctuation">]</span><span class="token punctuation">:</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdin</span><span class="token punctuation">&gt;</span></span>
       <span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>#parseInput<span class="token punctuation">(</span><span class="token string">"Int"</span><span class="token punctuation">,</span> Delimiters<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       <span class="token operator">=&gt;</span> ListItem<span class="token punctuation">(</span>String2Int<span class="token punctuation">(</span>substrString<span class="token punctuation">(</span>S<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> findChar<span class="token punctuation">(</span>S<span class="token punctuation">,</span> Delimiters<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>S<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> substrString<span class="token punctuation">(</span>S<span class="token punctuation">,</span>findChar<span class="token punctuation">(</span>S<span class="token punctuation">,</span> Delimiters<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">,</span> lengthString<span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       _<span class="token punctuation">:</span>List
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdin</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">requires</span> findChar<span class="token punctuation">(</span>S<span class="token punctuation">,</span> Delimiters<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token operator">-</span><span class="token number">1</span>
       andBool lengthString<span class="token punctuation">(</span>S<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">1</span> <span class="token comment">// [stdin]</span>
       <span class="token punctuation">[</span>stream<span class="token punctuation">]</span>

  <span class="token keyword">rule</span> <span class="token punctuation">[</span>stdinTrim<span class="token punctuation">]</span><span class="token punctuation">:</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdin</span><span class="token punctuation">&gt;</span></span>
       ListItem<span class="token punctuation">(</span>#parseInput<span class="token punctuation">(</span>Sort<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> Delimiters<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>S<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> substrString<span class="token punctuation">(</span>S<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> lengthString<span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       _<span class="token punctuation">:</span>List
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdin</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">requires</span> findChar<span class="token punctuation">(</span>S<span class="token punctuation">,</span> Delimiters<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token operator">-</span><span class="token number">1</span>
       andBool Sort <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">String</span> <span class="token string">"String"</span>
       andBool lengthString<span class="token punctuation">(</span>S<span class="token punctuation">)</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token comment">// [stdin]</span>
       <span class="token punctuation">[</span>stream<span class="token punctuation">]</span>

  <span class="token comment">// NOTE: This unblocking rule will be instantiated and inserted carefully</span>
  <span class="token comment">// when necessary according to user-defined rules, since otherwise it will</span>
  <span class="token comment">// lead to a diverging (i.e., non-terminating) transition system definition.</span>
  <span class="token comment">// Currently, it supports only a simple pattern matching on the top of the</span>
  <span class="token comment">// input stream cell, e.g.,</span>
  <span class="token comment">//   rule &lt;k&gt; read() =&gt; V ... &lt;/k&gt; &lt;in&gt; ListItem(V:Int) =&gt; .List ...  &lt;/in&gt;</span>
  <span class="token comment">// Non-supported rules that refer to the input stream cell in a sophisticated</span>
  <span class="token comment">// way will get stuck in concrete execution mode with real IO enabled (i.e.,</span>
  <span class="token comment">// under `--io on` option), while they will still work in symbolic execution</span>
  <span class="token comment">// mode or concrete execution mode with real IO disabled (i.e., under `--io</span>
  <span class="token comment">// off`, `--search`, or `--debug` options).</span>
  <span class="token comment">//</span>
  <span class="token comment">// TODO: More patterns need to be supported as well. In that case, we need to</span>
  <span class="token comment">// have a way to specify such patterns.</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>stdinUnblock<span class="token punctuation">]</span><span class="token punctuation">:</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdin</span><span class="token punctuation">&gt;</span></span>
         <span class="token punctuation">(</span><span class="token punctuation">.</span>List <span class="token operator">=&gt;</span> ListItem<span class="token punctuation">(</span>#parseInput<span class="token punctuation">(</span><span class="token operator">?</span>Sort<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">?</span>Delimiters<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>_<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdin</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">/*
  syntax Stream ::= "#noIO"

  rule ListItem(#buffer(_))
       (ListItem(#noIO) ListItem(#istream(_:Int)) =&gt; .List) [stdin]
  */</span>

<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> STDOUT<span class="token operator">-</span>STREAM
  <span class="token keyword">imports</span> K<span class="token operator">-</span>IO
  <span class="token keyword">imports</span> LIST
  <span class="token keyword">imports</span> STRING

  <span class="token keyword">configuration</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdout</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>#ostream<span class="token punctuation">(</span>#stdout<span class="token punctuation">)</span><span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>$IO<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdout</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">//configuration &lt;stderr&gt; ListItem(#ostream(#stderr)) ListItem($IO:String) ListItem(#buffer("")) &lt;/stderr&gt;</span>

  <span class="token keyword">rule</span> <span class="token punctuation">[</span>stdoutBufferFloat<span class="token punctuation">]</span><span class="token punctuation">:</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdout</span><span class="token punctuation">&gt;</span></span>
       ListItem<span class="token punctuation">(</span>#ostream<span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>_<span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>Buffer<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> Buffer <span class="token operator">+</span><span class="token keyword">String</span> Float2String<span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       <span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>F<span class="token punctuation">:</span><span class="token keyword">Float</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>List<span class="token punctuation">)</span>
       _<span class="token punctuation">:</span>List
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdout</span><span class="token punctuation">&gt;</span></span>
       <span class="token comment">// [stdout, stderr]</span>
       <span class="token punctuation">[</span>stream<span class="token punctuation">,</span> priority<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>stdoutBufferInt<span class="token punctuation">]</span><span class="token punctuation">:</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdout</span><span class="token punctuation">&gt;</span></span>
       ListItem<span class="token punctuation">(</span>#ostream<span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>_<span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>Buffer<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> Buffer <span class="token operator">+</span><span class="token keyword">String</span> Int2String<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       <span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>I<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>List<span class="token punctuation">)</span>
       _<span class="token punctuation">:</span>List
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdout</span><span class="token punctuation">&gt;</span></span>
       <span class="token comment">// [stdout, stderr]</span>
       <span class="token punctuation">[</span>stream<span class="token punctuation">,</span> priority<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>stdoutBufferString<span class="token punctuation">]</span><span class="token punctuation">:</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdout</span><span class="token punctuation">&gt;</span></span>
       ListItem<span class="token punctuation">(</span>#ostream<span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>_<span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>Buffer<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> Buffer <span class="token operator">+</span><span class="token keyword">String</span> S<span class="token punctuation">)</span><span class="token punctuation">)</span>
       <span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>S<span class="token punctuation">:</span><span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>List<span class="token punctuation">)</span>
       _<span class="token punctuation">:</span>List
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdout</span><span class="token punctuation">&gt;</span></span>
       <span class="token comment">// [stdout, stderr]</span>
       <span class="token punctuation">[</span>stream<span class="token punctuation">,</span> priority<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token comment">// Send first char from the buffer to the server</span>
  <span class="token keyword">rule</span> <span class="token punctuation">[</span>stdoutWrite<span class="token punctuation">]</span><span class="token punctuation">:</span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdout</span><span class="token punctuation">&gt;</span></span>
       ListItem<span class="token punctuation">(</span>#ostream<span class="token punctuation">(</span>N<span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>#write<span class="token punctuation">(</span>N<span class="token punctuation">,</span> S<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">}</span><span class="token punctuation">:</span>&gt;<span class="token keyword">Int</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span><span class="token string">"on"</span><span class="token punctuation">)</span>
       ListItem<span class="token punctuation">(</span>#buffer<span class="token punctuation">(</span>S<span class="token punctuation">:</span><span class="token keyword">String</span> <span class="token operator">=&gt;</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
       _<span class="token punctuation">:</span>List
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stdout</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">requires</span> S <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">String</span> <span class="token string">""</span> <span class="token comment">// [stdout, stderr]</span>
       <span class="token punctuation">[</span>stream<span class="token punctuation">,</span> priority<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token comment">/*
  syntax Stream ::= "#noIO"

  rule ListItem(#buffer(Buffer:String =&gt; Buffer +String Float2String(F)))
       (ListItem(F:Float) =&gt; .List)
       _:List [stdout, stderr]
  rule ListItem(#buffer(Buffer:String =&gt; Buffer +String Int2String(I)))
       (ListItem(I:Int) =&gt; .List)
       _:List [stdout, stderr]
  rule ListItem(#buffer(Buffer:String =&gt; Buffer +String S))
       (ListItem(S:String) =&gt; .List)
       _:List [stdout, stderr]

  rule (ListItem(#ostream(_:Int)) ListItem(#noIO) =&gt; .List)
       ListItem(#buffer(_))
       _:List [stdout, stderr]
  */</span>

<span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="machine-integers">Machine Integers</h2>
<p>Provided here is an implementation of arbitrarily large fixed-precision binary
integers in K. This type is hooked to an implementation of integers provided
by the backend, and in particular makes use of native machine integers for
certain sizes of integer. For arbitrary-precision integers, see the <code>INT</code>
module above.</p>
<p>The syntax of machine integers in K is the same as arbitrary-precision integers
(i.e., an optional sign followed by a sequence of digits) except that machine
integers always end in a suffix <code>pN</code> where <code>N</code> is an integer indicating the
width in bits of the integer. The <code>MInt</code> sort is parametric, and this is
reflected in the literals. For example, the sort of <code>0p8</code> is <code>MInt{8}</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">module</span> MINT<span class="token operator">-</span>SYNTAX
  <span class="token comment">/*@\section{Description} The MInt implements machine integers of arbitrary
   * bit width represented in 2's complement. */</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>MInt<span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token comment">/*@ Machine integer of bit width and value. */</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> r<span class="token string">"[\\+\\-]?[0-9]+[pP][0-9]+"</span> <span class="token punctuation">[</span><span class="token class-name">token</span><span class="token punctuation">,</span> prec<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>literal<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>

<span class="token keyword">module</span> MINT
  <span class="token keyword">imports</span> MINT<span class="token operator">-</span>SYNTAX
  <span class="token keyword">imports</span> private INT
  <span class="token keyword">imports</span> private BYTES
  <span class="token keyword">imports</span> private BOOL
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="bitwidth-of-mint">Bitwidth of MInt</h3>
<p>You can get the number of bits of width in an MInt using <code>bitwidthMInt</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> bitwidthMInt<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>bitwidth<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="int-and-mint-conversions">Int and MInt conversions</h3>
<p>You can convert from an <code>MInt</code> to an <code>Int</code> using the <code>MInt2Signed</code> and
<code>MInt2Unsigned</code> functions. an <code>MInt</code> does not have a sign; its sign is instead
reflected in how operators interpret its value either as a signed integer or as
an unsigned integer. Thus, you can interpret a <code>MInt</code> as a signed integer witth
<code>MInt2Signed</code>, or as an unsigned integer respectively using <code>MInt2Unsigned</code>.</p>
<p>You can also convert from an <code>Int</code> to an <code>MInt</code> using <code>Int2MInt</code>. Care must
be given to ensure that the sort context where the <code>Int2MInt</code> operator appears
has the correct bitwidth, as this will influence the width of the resulting
<code>MInt</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> MInt2Signed<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>svalue<span class="token punctuation">)</span><span class="token punctuation">]</span>
                       <span class="token operator">|</span> MInt2Unsigned<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span>     <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>uvalue<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bv2int<span class="token punctuation">)</span><span class="token punctuation">]</span>

  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Int2MInt<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>integer<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>int2bv<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="mint-and-bytes-conversion">Mint and Bytes conversion</h3>
<p>You can convert from an <code>MInt</code> to a <code>Bytes</code> using the <code>MInt2Bytes</code> function.
Currently we only support converting <code>MInt</code>s of width 256 to <code>Bytes</code> in a Big Endian format.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> MInt2Bytes<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>MInt2bytes<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Bytes2MInt<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>bytes2MInt<span class="token punctuation">)</span><span class="token punctuation">]</span> 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="mint-min-and-max-values">MInt min and max values</h3>
<p>You can get the minimum and maximum values of a signed or unsigned <code>MInt</code>
with az specified bit width using <code>sminMInt</code>, <code>smaxMInt</code>, <code>uminMInt</code>, and
<code>umaxMInt</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> sminMInt<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
               <span class="token operator">|</span> smaxMInt<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
               <span class="token operator">|</span> uminMInt<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
               <span class="token operator">|</span> umaxMInt<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
  <span class="token keyword">rule</span> sminMInt<span class="token punctuation">(</span>N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> <span class="token punctuation">(</span>N <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">rule</span> smaxMInt<span class="token punctuation">(</span>N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> <span class="token punctuation">(</span>N <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span>
  <span class="token keyword">rule</span> uminMInt<span class="token punctuation">(</span>_<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
  <span class="token keyword">rule</span> umaxMInt<span class="token punctuation">(</span>N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> N<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="mint-bounds-checking">MInt bounds checking</h3>
<p>You can check whether a specified <code>Int</code> will be represented in an <code>MInt</code>
with a specified <code>width</code> without any loss of precision when interpreted as
a signed or unsigned integer using <code>soverflowMInt</code> and <code>uoverflowMInt</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> soverflowMInt<span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>   <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
                <span class="token operator">|</span> uoverflowMInt<span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>   <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
  <span class="token keyword">rule</span>
    soverflowMInt<span class="token punctuation">(</span>N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> I<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span>
  <span class="token operator">=&gt;</span>
    I <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Int</span> <span class="token attr-name">sminMInt(N)</span> <span class="token attr-name">orBool</span> <span class="token attr-name">I</span> <span class="token punctuation">&gt;</span></span><span class="token keyword">Int</span> smaxMInt<span class="token punctuation">(</span>N<span class="token punctuation">)</span>
  <span class="token keyword">rule</span>
    uoverflowMInt<span class="token punctuation">(</span>N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> I<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span>
  <span class="token operator">=&gt;</span>
    I <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Int</span> <span class="token attr-name">uminMInt(N)</span> <span class="token attr-name">orBool</span> <span class="token attr-name">I</span> <span class="token punctuation">&gt;</span></span><span class="token keyword">Int</span> umaxMInt<span class="token punctuation">(</span>N<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="mint-arithmetic">MInt arithmetic</h3>
<p>You can:</p>
<ul>
<li>Compute the bitwise complement <code>~MInt</code> of an <code>MInt</code>.</li>
<li>Compute the unary negation <code>--MInt</code> of an <code>MInt</code>.</li>
<li>Compute the power <code>^MInt</code> of two <code>MInt</code>s interpreted as unsigned integers.
Currently, only 64 and 256-bits is supported.</li>
<li>Compute the product <code>*MInt</code> of two <code>MInt</code>s.</li>
<li>Compute the quotient <code>/sMInt</code> of two <code>MInt</code>s interpreted as signed integers.</li>
<li>Compute the modulus <code>%sMInt</code> of two <code>MInt</code>s interpreted as signed integers.</li>
<li>Compute the quotient <code>/uMInt</code> of two <code>MInt</code>s interpreted as unsigned
integers.</li>
<li>Compute the modulus <code>%uMInt</code> of two <code>MInt</code>s interpreted as unsigned integers.</li>
<li>Compute the sum <code>+MInt</code> of two <code>MInt</code>s.</li>
<li>Compute the difference <code>-MInt</code> of two <code>MInt</code>s.</li>
<li>Compute the left shift <code>&lt;&lt;MInt</code> of two <code>MInt</code>s. The second <code>MInt</code> is always
interpreted as positive.</li>
<li>Compute the arithmetic right shift <code>&gt;&gt;aMInt</code> of two <code>MInt</code>s. The second
<code>MInt</code> is always interpreted as positve.</li>
<li>Compute the logical right shift <code>&gt;&gt;lMInt</code> of two <code>MInt</code>s. The second <code>MInt</code>
is always interpreted as positive.</li>
<li>Compute the bitwise and <code>&amp;MInt</code> of two <code>MInt</code>s.</li>
<li>Compute the bitwise xor <code>xorMInt</code> of two <code>MInt</code>s.</li>
<li>Compute the bitwise inclusive or <code>|MInt</code> of two <code>MInt</code>s.</li>
</ul>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"~MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>not<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvnot<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> <span class="token string">"--MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>neg<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvuminus<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                                 MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"^MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>pow<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"*MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>mul<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvmul<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"/sMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>sdiv<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvsdiv<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"%sMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>srem<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvsrem<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"/uMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>udiv<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvudiv<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"%uMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>urem<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvurem<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                                 MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"+MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>add<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvadd<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"-MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>sub<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvsub<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                                 MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&lt;&lt;MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>shl<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvshl<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&gt;&gt;aMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>ashr<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvashr<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&gt;&gt;lMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>lshr<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvlshr<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                                 MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&amp;MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>and<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvand<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                                 MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"xorMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>xor<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvxor<span class="token punctuation">)</span><span class="token punctuation">]</span>
                               &gt; <span class="token class-name">left</span><span class="token punctuation">:</span>
                                 MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"|MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>or<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvor<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="mint-comparison">MInt comparison</h3>
<p>You can compute whether one <code>MInt</code> is less than, less than or equal to, greater
than, or greater than or equal to another <code>MInt</code> when interpreted as signed
or unsigned integers. You can also compute whether one <code>MInt</code> is equal to or
unequal to another <code>MInt</code>.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&lt;sMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>slt<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvslt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&lt;uMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>ult<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvult<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&lt;=sMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>sle<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvsle<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&lt;=uMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>ule<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvule<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&gt;sMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>sgt<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvsgt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&gt;uMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>ugt<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvugt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&gt;=sMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>sge<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvsge<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"&gt;=uMInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>uge<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>bvuge<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"==MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>eq<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token operator">=</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token string">"=/=MInt"</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>ne<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span>distinct<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="mint-min%2Fmax">MInt min/max</h3>
<p>You can compute the signed minimum <code>sMinMInt</code>, the signed maximum <code>sMaxMInt</code>,
the unsigned minimum <code>uMinMInt</code>, and the unsigned maximum <code>uMaxMInt</code> of two
<code>MInt</code>s.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> sMaxMInt<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">,</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>smax<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>ite <span class="token punctuation">(</span>bvslt #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> #<span class="token number">2</span> #<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> sMinMInt<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">,</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>smin<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>ite <span class="token punctuation">(</span>bvslt #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> uMaxMInt<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">,</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>umax<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>ite <span class="token punctuation">(</span>bvult #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> #<span class="token number">2</span> #<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                               <span class="token operator">|</span> uMinMInt<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">,</span> MInt<span class="token punctuation">{</span>Width<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>umin<span class="token punctuation">)</span><span class="token punctuation">,</span> smt<span class="token operator">-</span>hook<span class="token punctuation">(</span><span class="token punctuation">(</span>ite <span class="token punctuation">(</span>bvult #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span> #<span class="token number">1</span> #<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="mint-to-mint-conversion">MInt to MInt conversion</h3>
<p>You can convert an <code>MInt</code> of one width to another width with <code>roundMInt</code>.
The resulting <code>MInt</code> will be truncated starting from the most significant bit
if the resulting width is smaller than the input. The resulting <code>MInt</code> will be
zero-extended with the same low-order bits if the resulting width is larger
than the input.</p>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k">  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width1<span class="token punctuation">,</span> Width2<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width1<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> roundMInt<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>round<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">syntax</span> <span class="token punctuation">{</span>Width1<span class="token punctuation">,</span> Width2<span class="token punctuation">}</span> MInt<span class="token punctuation">{</span>Width1<span class="token punctuation">}</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> signExtendMInt<span class="token punctuation">(</span>MInt<span class="token punctuation">{</span>Width2<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> hook<span class="token punctuation">(</span>MINT<span class="token punctuation">.</span>sext<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre style="position: relative; padding-top: 32px; counter-reset: linenumber 0;" class="line-numbers language-line-numbers" data-start="1"><div class="code-block-selectors">k</div><code class="language-k"><span class="token keyword">endmodule</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</body></html></div>
        </main>

        <!-- Page ToC -->
        <div class="col-12 col-md-3 col-xl-2 py-md-3 bd-sidebar page-toc mb-3">
          
<div>
<details style="padding:0.25rem 0;;padding-left: 0px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#basic-builtin-types-in-k" class="bd-toc-link">Basic Builtin Types in K</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#default-modules"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Default Modules
              </a></div><details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#arrays" class="bd-toc-link">Arrays</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#array-lookup"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Array lookup
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#array-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Array update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#array-reset"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Array reset
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#multiple-array-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Multiple array update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#array-fill"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Array fill
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#array-range-check"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Array range check
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#array-creation"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Array creation
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#implementation-of-arrays"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Implementation of Arrays
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#maps" class="bd-toc-link">Maps</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-concatenation"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map concatenation
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-unit"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map unit
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-elements"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map elements
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-lookup"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map lookup
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-lookup-with-default"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map lookup with default
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-delete"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map delete
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-difference"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map difference
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#multiple-map-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Multiple map update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#multiple-map-removal"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Multiple map removal
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-keys-(as-set)"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map keys (as <code>Set</code>)
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-keys-(as-list)"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map keys (as <code>List</code>)
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-key-membership"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map key membership
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-values-(as-list)"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map values (as <code>List</code>)
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-size"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map size
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-inclusion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map inclusion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#map-choice"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Map choice
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#implementation-of-maps"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Implementation of Maps
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#range-maps" class="bd-toc-link">Range Maps</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range%2C-bounded-inclusively-below-and-exclusively-above."
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range, bounded inclusively below and exclusively above.
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-concatenation"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map concatenation
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-unit"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map unit
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-elements"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map elements
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-lookup"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map lookup
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-lookup-with-default"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map lookup with default
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-lookup-for-range-of-key"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map lookup for range of key
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-delete"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map delete
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-difference"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map difference
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#multiple-range-map-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Multiple range map update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#multiple-range-map-removal"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Multiple range map removal
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-keys-(as-set)"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map keys (as <code>Set</code>)
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-keys-(as-list)"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map keys (as <code>List</code>)
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-key-membership"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map key membership
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-values-(as-list)"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map values (as <code>List</code>)
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-size"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map size
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-inclusion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map inclusion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#range-map-choice"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Range map choice
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#sets" class="bd-toc-link">Sets</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-concatenation"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set concatenation
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-unit"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set unit
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-elements"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set elements
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-union"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set union
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-intersection"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set intersection
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-complement"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set complement
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-membership"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set membership
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-inclusion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set inclusion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-size"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set size
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#set-choice"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Set choice
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#implementation-of-sets"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Implementation of Sets
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#lists" class="bd-toc-link">Lists</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-concatenation"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List concatenation
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-unit"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List unit
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-elements"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List elements
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-prepend"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List prepend
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-indexing"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List indexing
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-of-identical-elements"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List of identical elements
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#multiple-list-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Multiple list update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-fill"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List fill
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-slicing"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List slicing
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-membership"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List membership
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#list-size"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                List size
              </a></div>
            </div>
          </details>
        <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#collection-conversions"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Collection Conversions
              </a></div><details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#booleans" class="bd-toc-link">Booleans</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#basic-boolean-arithmetic"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Basic boolean arithmetic
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#implementation-of-booleans"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Implementation of Booleans
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#integers" class="bd-toc-link">Integers</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#integer-arithmetic"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Integer arithmetic
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#integer-minimum-and-maximum"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Integer minimum and maximum
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#absolute-value"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Absolute value
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#log-base-2"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Log base 2
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#bit-slicing"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Bit slicing
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#integer-comparisons"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Integer comparisons
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#divides"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Divides
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#random-integers"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Random integers
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#implementation-of-integers"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Implementation of Integers
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#ieee-754-floating-point-numbers" class="bd-toc-link">IEEE 754 Floating-point Numbers</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#float-precision"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Float precision
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#float-exponent-bits"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Float exponent bits
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#float-exponent"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Float exponent
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#float-sign"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Float sign
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#float-special-values"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Float special values
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#float-arithmetic"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Float arithmetic
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#floating-point-mathematics"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Floating-point mathematics
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#floating-point-comparisons"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Floating-point comparisons
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#conversion-between-integer-and-float"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Conversion between integer and float
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#implementation-of-floats"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Implementation of Floats
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#strings" class="bd-toc-link">Strings</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-concatenation"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String concatenation
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-length"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String length
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#character-and-integer-conversion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Character and integer conversion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-substring"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String substring
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-search"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String search
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-character-search"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String character search
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-and-bool-conversion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String and Bool conversion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-and-float-conversion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String and float conversion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-and-integer-conversions"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String and integer conversions
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-count-and-replace"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String count and replace
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-equality-and-lexicographic-comparison"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String equality and lexicographic comparison
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#implementation-of-strings"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Implementation of Strings
              </a></div>
            </div>
          </details>
        <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-buffers"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                String Buffers
              </a></div><details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#byte-arrays" class="bd-toc-link">Byte Arrays</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#encoding%2Fdecoding-between-bytes-and-string"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Encoding/decoding between Bytes and String
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#empty-byte-array"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Empty byte array
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#endianness"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Endianness
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#signedness"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Signedness
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#integer-and-bytes-conversion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Integer and Bytes conversion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#string-and-bytes-conversion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                String and Bytes conversion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#bytes-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Bytes update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#bytes-lookup"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Bytes lookup
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#bytes-substring"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Bytes substring
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#multiple-bytes-update"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Multiple bytes update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#multiple-bytes-update-1"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Multiple bytes update
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#bytes-padding"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Bytes padding
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#bytes-reverse"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Bytes reverse
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#bytes-length"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Bytes length
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#bytes-concatenation"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Bytes concatenation
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#implementation-of-bytes"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Implementation of Bytes
              </a></div>
            </div>
          </details>
        <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#program-identifiers"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Program identifiers
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#equality-and-conditionals"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Equality and conditionals
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#meta-operations"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Meta operations
              </a></div><details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#i%2Fo-in-k" class="bd-toc-link">I/O in K</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#i%2Fo-errors"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                I/O errors
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#i%2Fo-result-sorts"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                I/O result sorts
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#opening-a-file"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Opening a file
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#get%2Fset-position-in-file"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Get/set position in file
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#read-from-file"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Read from file
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#write-to-file"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Write to file
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#closing-a-file"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Closing a file
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#locking%2Funlocking-a-file"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Locking/unlocking a file
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#networking"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Networking
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#time"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Time
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#builtin-file-descriptors"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Builtin file descriptors
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#shell-access"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Shell access
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#temporary-files"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Temporary files
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#deleting-a-file"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Deleting a file
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#logging"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Logging
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#implementation-of-high-level-i%2Fo-streams-in-k"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Implementation of high-level I/O streams in K
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#machine-integers" class="bd-toc-link">Machine Integers</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#bitwidth-of-mint"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Bitwidth of MInt
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#int-and-mint-conversions"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Int and MInt conversions
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#mint-and-bytes-conversion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Mint and Bytes conversion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#mint-min-and-max-values"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                MInt min and max values
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#mint-bounds-checking"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                MInt bounds checking
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#mint-arithmetic"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                MInt arithmetic
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#mint-comparison"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                MInt comparison
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#mint-min%2Fmax"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                MInt min/max
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#mint-to-mint-conversion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                MInt to MInt conversion
              </a></div>
            </div>
          </details>
        
            </div>
          </details>
        
</div>

        </div>
        <div class="btn btn-rv-blue page-toc-toggle-btn"></div>
        <!-- End Page ToC -->
      </div>
    </div>
<!-- The footer is now controlled by the k-web-theme git submodule -->
<footer id="rvsite-footer" class="app-footer text-md-left text-center">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-4 mb-md-0 mb-4">
        <a href="https://runtimeverification.com/" target="_blank">
          <picture>
            <source
              srcset="
                https://runtimeverification.com/assets/img/rv-logo-dark.png
              "
              media="(prefers-color-scheme: dark)"
            />
            <img
              class="logo-dark"
              src="https://runtimeverification.com/assets/img/rv-logo.png"
              alt="Runtime Verification logo"
              style="height: 32px"
            /> </picture
        ></a>
        <p class="mt-2 text-md-left copyright">
          <a href="https://maps.app.goo.gl/8YhKozfmZtgzQBsH7" target="_blank"
            >202 S Broadway Ave #31, Urbana, IL</a
          >
        </p>
      </div>
      <div class="col-md-4 text-md-center mb-md-0 mb-4"></div>
      <div class="col-md-4 mb-md-0 mb-4 pl-0 text-md-right">
        <p class="copyright">2025 © all rights reserved</p>
        <span class="copyright"
          ><a href="https://runtimeverification.com/privacy-policy"
            >privacy policy</a
          >
          |
          <a href="https://runtimeverification.com/terms-of-use"
            >terms of use</a
          ></span
        >
      </div>
    </div>
  </div>
</footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/Typist/1.2/typist.min.js"></script>
    <script src="../../../../../assets/js/index.js"></script>
    <script>
      $(function () {
        // Render youtube video
        const anchorElements = document.querySelectorAll(".markdown-preview a");
        for (let i = anchorElements.length - 1; i >= 0; i--) {
          if (anchorElements.length - 1 - i > 3) {
            break;
          }
          const anchorElement = anchorElements[i];
          const href = anchorElement.getAttribute("href");
          if (href.match(/^https?:\/\/youtu.be\//)) {
            const match = href.match(/^https?:\/\/youtu.be\/(.+?)$/);
            if (match && match[1]) {
              const youtubeId = match[1];
              const $iframe = $(`
<div style="text-align:center;">
  <iframe
    width="560"
    height="315"
    src="https://www.youtube.com/embed/${youtubeId}"
    frameborder="0"
    allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    style="max-width: 100%;"
  ></iframe>
  <p>The video is out of date</p>
</div>
`);
              $(anchorElement).replaceWith($iframe[0]);
            }
          }
        }
      });
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-9LBGDMRG32"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-9LBGDMRG32");
    </script>
  </body>
</html>
